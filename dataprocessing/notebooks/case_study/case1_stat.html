<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Case Study 1 - Multiple Runs &mdash; RAI Error Mitigation  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Case Study 2 - Multiple Runs" href="case2_stat.html" />
    <link rel="prev" title="Case Study 3" href="case3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> RAI Error Mitigation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../databalanceanalysis/databalanceanalysis.html">databalanceanalysis</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../intro.html">dataprocessing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#target-audience">Target Audience</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#structure">Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#api">API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../intro.html#examples">Examples</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../case_studies.html">Case Studies</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../module_tests/model_test.html">Simple Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="case1.html">Case Study 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="case2.html">Case Study 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="case3.html">Case Study 3</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Case Study 1 - Multiple Runs</a></li>
<li class="toctree-l4"><a class="reference internal" href="case2_stat.html">Case Study 2 - Multiple Runs</a></li>
<li class="toctree-l4"><a class="reference internal" href="case3_stat.html">Case Study 3 - Multiple Runs</a></li>
<li class="toctree-l4"><a class="reference internal" href="case4_stat.html">Case Study 4 - Multiple Runs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../module_tests.html">Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#sklearn-s-pipeline-support">Sklearn’s Pipeline Support</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">RAI Error Mitigation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../intro.html">dataprocessing</a> &raquo;</li>
          <li><a href="../../case_studies.html">Case Studies</a> &raquo;</li>
      <li>Case Study 1 - Multiple Runs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/dataprocessing/notebooks/case_study/case1_stat.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Case-Study-1---Multiple-Runs">
<h1>Case Study 1 - Multiple Runs<a class="headerlink" href="#Case-Study-1---Multiple-Runs" title="Permalink to this heading"></a></h1>
<p>This notebook serves as a second part of the <strong>case1.ipynb</strong> notebook. Here we run the same experimento several times, with different train/test splits, in order to test the average results obtained. We do this to test if a preprocessing step manages to improve the model’s result with some statistical significance. In the <strong>case1.ipynb</strong> notebook we tested a single train/test split, and some of the results we observed might not hold for different splits. Maybe we just got lucky with our
train/test split. To avoid these pitfalls, we will try each experiment several times and record the average behavior.</p>
<section id="0---Defining-Basic-Functionalities">
<h2>0 - Defining Basic Functionalities<a class="headerlink" href="#0---Defining-Basic-Functionalities" title="Permalink to this heading"></a></h2>
<p>The next cell contains several helper functions that will be used throughout this notebook. Here we create some functions for training a model and assessing its performance in a test set. We also create functions for encoding the data using the <strong>dataprocessing</strong> library. Some functions are tailored specifically for the dataset used here and won’t generalize to other datasets.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">uci_dataset</span> <span class="k">as</span> <span class="nn">database</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">figure</span>

<span class="kn">import</span> <span class="nn">raimitigations.dataprocessing</span> <span class="k">as</span> <span class="nn">dp</span>

<span class="n">N_EXEC</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">USE_AUC_TH</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">RESULT_KEYS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;roc&quot;</span><span class="p">,</span> <span class="s2">&quot;pr&quot;</span><span class="p">,</span> <span class="s2">&quot;rc&quot;</span><span class="p">,</span> <span class="s2">&quot;f1&quot;</span><span class="p">]</span>
<span class="n">COL_METRIC</span> <span class="o">=</span> <span class="s2">&quot;Metric&quot;</span>
<span class="n">COL_VALUE</span> <span class="o">=</span> <span class="s2">&quot;Value&quot;</span>
<span class="n">COL_TEST</span> <span class="o">=</span> <span class="s2">&quot;Test Case&quot;</span>

<span class="n">SEQ_FWD</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">SEQ_BWD</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CATBOOST</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">get_encoders</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">age_order</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">age_order</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">tumor_size_order</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tumor-size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">tumor_size_order</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">inv_nodes_order</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;inv-nodes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">inv_nodes_order</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c1"># Encode &#39;tumor-size&#39;, and &#39;inv-nodes&#39; using ordinal encoding</span>
    <span class="n">enc_ord</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">EncoderOrdinal</span><span class="p">(</span><span class="n">col_encode</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;tumor-size&quot;</span><span class="p">,</span> <span class="s2">&quot;inv-nodes&quot;</span><span class="p">],</span>
                                                            <span class="n">categories</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;age&quot;</span><span class="p">:</span><span class="n">age_order</span><span class="p">,</span>
                                                                                    <span class="s2">&quot;tumor-size&quot;</span><span class="p">:</span><span class="n">tumor_size_order</span><span class="p">,</span>
                                                                                    <span class="s2">&quot;inv-nodes&quot;</span><span class="p">:</span><span class="n">inv_nodes_order</span><span class="p">},</span>
                                                            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
                                                    <span class="p">)</span>
    <span class="n">enc_ohe</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">EncoderOHE</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">unknown_err</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">enc_ord</span><span class="p">,</span> <span class="n">enc_ohe</span>

<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">encode_case1</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">enc_ord</span><span class="p">,</span> <span class="n">enc_ohe</span> <span class="o">=</span> <span class="n">get_encoders</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">enc_ord</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">enc_ord</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="c1"># Encode the remaining categorical columns using One-Hot Encoding</span>
    <span class="n">enc_ohe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">proc_df</span><span class="p">)</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">enc_ohe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">proc_df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">proc_df</span>


<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">encode_case1_train_test</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">):</span>
    <span class="n">enc_ord</span><span class="p">,</span> <span class="n">enc_ohe</span> <span class="o">=</span> <span class="n">get_encoders</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">enc_ord</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
    <span class="n">train_x_enc</span> <span class="o">=</span> <span class="n">enc_ord</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
    <span class="n">test_x_enc</span> <span class="o">=</span> <span class="n">enc_ord</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_x</span><span class="p">)</span>

    <span class="n">enc_ohe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x_enc</span><span class="p">)</span>
    <span class="n">train_x_enc</span> <span class="o">=</span> <span class="n">enc_ohe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_x_enc</span><span class="p">)</span>
    <span class="n">test_x_enc</span> <span class="o">=</span> <span class="n">enc_ohe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_x_enc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">train_x_enc</span><span class="p">,</span> <span class="n">test_x_enc</span>


<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">impute_case1</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">imputer</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">BasicImputer</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">imputer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">proc_df</span>


<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">impute_case1_train_test</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">):</span>
    <span class="n">imputer</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">BasicImputer</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">imputer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
    <span class="n">train_x_enc</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
    <span class="n">test_x_enc</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">train_x_enc</span><span class="p">,</span> <span class="n">test_x_enc</span>


<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">remove_corr_feat</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">):</span>
    <span class="n">cor_feat</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">CorrelatedFeatures</span><span class="p">(</span>
                                    <span class="n">method_num_num</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;spearman&quot;</span><span class="p">,</span> <span class="s2">&quot;pearson&quot;</span><span class="p">,</span> <span class="s2">&quot;kendall&quot;</span><span class="p">],</span>                              <span class="c1"># Used for Numerical x Numerical correlations</span>
                                    <span class="n">num_corr_th</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>                                                                                                <span class="c1"># Used for Numerical x Numerical correlations</span>
                                    <span class="n">num_pvalue_th</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>                                                                                             <span class="c1"># Used for Numerical x Numerical correlations</span>
                                    <span class="n">method_num_cat</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>                                                                                 <span class="c1"># Used for Numerical x Categorical correlations</span>
                                    <span class="n">model_metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f1&quot;</span><span class="p">,</span> <span class="s2">&quot;auc&quot;</span><span class="p">],</span>                                                                    <span class="c1"># Used for Numerical x Categorical correlations</span>
                                    <span class="n">metric_th</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>                                                                                                  <span class="c1"># Used for Numerical x Categorical correlations</span>
                                    <span class="n">cat_corr_th</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>                                                                                                <span class="c1"># Used for Categorical x Categorical correlations</span>
                                    <span class="n">cat_pvalue_th</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>                                                                                             <span class="c1"># Used for Categorical x Categorical correlations</span>
                                    <span class="n">save_json</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
                            <span class="p">)</span>
    <span class="n">cor_feat</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="o">=</span><span class="n">label_col</span><span class="p">)</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">cor_feat</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">proc_df</span>

<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">feature_selection</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">feat_sel_type</span> <span class="o">==</span> <span class="n">SEQ_FWD</span><span class="p">:</span>
            <span class="n">feat_sel</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">SeqFeatSelection</span><span class="p">(</span><span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">feat_sel_type</span> <span class="o">==</span> <span class="n">SEQ_BWD</span><span class="p">:</span>
            <span class="n">feat_sel</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">SeqFeatSelection</span><span class="p">(</span><span class="n">forward</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
            <span class="n">feat_sel</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">CatBoostSelection</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">feat_sel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">train_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">train_y</span><span class="p">)</span>
    <span class="n">train_x_sel</span> <span class="o">=</span> <span class="n">feat_sel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
    <span class="n">test_x_sel</span> <span class="o">=</span> <span class="n">feat_sel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_x</span><span class="p">)</span>

    <span class="n">features</span> <span class="o">=</span> <span class="n">feat_sel</span><span class="o">.</span><span class="n">get_selected_features</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">train_x_sel</span><span class="p">,</span> <span class="n">test_x_sel</span>

<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">artificial_smote</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">strategy</span><span class="p">,</span> <span class="n">under_sample</span><span class="p">):</span>
    <span class="n">rebalance</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">Rebalance</span><span class="p">(</span>
                            <span class="n">X</span><span class="o">=</span><span class="n">train_x</span><span class="p">,</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">train_y</span><span class="p">,</span>
                            <span class="n">strategy_over</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span>
                            <span class="n">over_sampler</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">under_sampler</span><span class="o">=</span><span class="n">under_sample</span><span class="p">,</span>
                            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
                    <span class="p">)</span>
    <span class="n">train_x_res</span><span class="p">,</span> <span class="n">train_y_res</span> <span class="o">=</span> <span class="n">rebalance</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">train_x_res</span><span class="p">,</span> <span class="n">train_y_res</span>

<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">artificial_ctgan</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">strategy</span><span class="p">,</span> <span class="n">savefile</span><span class="p">):</span>
    <span class="n">synth</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">Synthesizer</span><span class="p">(</span>
                            <span class="n">X</span><span class="o">=</span><span class="n">train_x</span><span class="p">,</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">train_y</span><span class="p">,</span>
                            <span class="n">epochs</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                            <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ctgan&quot;</span><span class="p">,</span>
                            <span class="n">load_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">save_file</span><span class="o">=</span><span class="n">savefile</span><span class="p">,</span>
                            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
                    <span class="p">)</span>
    <span class="n">synth</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">syn_train_x</span><span class="p">,</span> <span class="n">syn_train_y</span> <span class="o">=</span> <span class="n">synth</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">train_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">train_y</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">syn_train_x</span><span class="p">,</span> <span class="n">syn_train_y</span>

<span class="c1"># -----------------------------------</span>
<span class="c1"># -----------------------------------</span>
<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">result_statistics</span><span class="p">(</span><span class="n">result_list</span><span class="p">):</span>
    <span class="n">result_stat</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">result_list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">RESULT_KEYS</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result_stat</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">result_stat</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                            <span class="n">result_stat</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>

    <span class="k">return</span> <span class="n">result_stat</span>


<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">result_stat</span><span class="p">,</span> <span class="n">test_name</span><span class="p">):</span>
    <span class="n">col_test</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">col_metric</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">col_value</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">RESULT_KEYS</span><span class="p">:</span>
            <span class="n">col_value</span> <span class="o">+=</span> <span class="n">result_stat</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span>
            <span class="n">col_test</span> <span class="o">+=</span> <span class="p">[</span><span class="n">test_name</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result_stat</span><span class="p">[</span><span class="n">metric</span><span class="p">]))]</span>
            <span class="n">col_metric</span> <span class="o">+=</span> <span class="p">[</span><span class="n">metric</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result_stat</span><span class="p">[</span><span class="n">metric</span><span class="p">]))]</span>

    <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">new_df</span><span class="p">[</span><span class="n">COL_VALUE</span><span class="p">]</span> <span class="o">=</span> <span class="n">col_value</span>
    <span class="n">new_df</span><span class="p">[</span><span class="n">COL_TEST</span><span class="p">]</span> <span class="o">=</span> <span class="n">col_test</span>
    <span class="n">new_df</span><span class="p">[</span><span class="n">COL_METRIC</span><span class="p">]</span> <span class="o">=</span> <span class="n">col_metric</span>
    <span class="n">new_df</span><span class="p">[</span><span class="n">COL_VALUE</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">COL_VALUE</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new_df</span>

    <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">result_df</span><span class="p">,</span> <span class="n">new_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result_df</span>


<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">test_base</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">n_exec</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    <span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">encode_case1</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">impute_case1</span><span class="p">(</span><span class="n">proc_df</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exec</span><span class="p">):</span>
            <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span><span class="n">proc_df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">train_model_fetch_results</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">USE_AUC_TH</span><span class="p">)</span>
            <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="n">result_stat</span> <span class="o">=</span> <span class="n">result_statistics</span><span class="p">(</span><span class="n">result_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result_stat</span>


<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">test_corr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">n_exec</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    <span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">remove_corr_feat</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">)</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">encode_case1</span><span class="p">(</span><span class="n">proc_df</span><span class="p">)</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">impute_case1</span><span class="p">(</span><span class="n">proc_df</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exec</span><span class="p">):</span>
            <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span><span class="n">proc_df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">train_model_fetch_results</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">USE_AUC_TH</span><span class="p">)</span>
            <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="n">result_stat</span> <span class="o">=</span> <span class="n">result_statistics</span><span class="p">(</span><span class="n">result_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result_stat</span>

<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">test_smote</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">n_exec</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">under</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">df</span>
    <span class="k">if</span> <span class="n">rcorr</span><span class="p">:</span>
            <span class="n">proc_df</span> <span class="o">=</span> <span class="n">remove_corr_feat</span><span class="p">(</span><span class="n">proc_df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">)</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">encode_case1</span><span class="p">(</span><span class="n">proc_df</span><span class="p">)</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">impute_case1</span><span class="p">(</span><span class="n">proc_df</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exec</span><span class="p">):</span>
            <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span><span class="n">proc_df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">art_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span> <span class="o">=</span> <span class="n">artificial_smote</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">art_str</span><span class="p">,</span> <span class="n">under</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">feat_sel_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span> <span class="o">=</span> <span class="n">feature_selection</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">train_model_fetch_results</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">USE_AUC_TH</span><span class="p">)</span>
            <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="n">result_stat</span> <span class="o">=</span> <span class="n">result_statistics</span><span class="p">(</span><span class="n">result_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result_stat</span>



<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">test_ctgan_first</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">n_exec</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">proc_df</span> <span class="o">=</span> <span class="n">df</span>
    <span class="k">if</span> <span class="n">rcorr</span><span class="p">:</span>
            <span class="n">proc_df</span> <span class="o">=</span> <span class="n">remove_corr_feat</span><span class="p">(</span><span class="n">proc_df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exec</span><span class="p">):</span>
            <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span><span class="n">proc_df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">art_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span> <span class="o">=</span> <span class="n">artificial_ctgan</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">art_str</span><span class="p">,</span> <span class="n">savefile</span><span class="p">)</span>
            <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span> <span class="o">=</span> <span class="n">encode_case1_train_test</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">)</span>
            <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span> <span class="o">=</span> <span class="n">impute_case1_train_test</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">feat_sel_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">train_x</span><span class="p">,</span> <span class="n">test_x</span> <span class="o">=</span> <span class="n">feature_selection</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">train_model_fetch_results</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">USE_AUC_TH</span><span class="p">)</span>
            <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="n">result_stat</span> <span class="o">=</span> <span class="n">result_statistics</span><span class="p">(</span><span class="n">result_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result_stat</span>

<span class="c1"># -----------------------------------</span>
<span class="c1"># -----------------------------------</span>
<span class="c1"># -----------------------------------</span>
<span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span><span class="n">res_df</span><span class="p">,</span> <span class="n">y_lim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#fig.set_dpi(100)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">COL_METRIC</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">COL_VALUE</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">COL_TEST</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">res_df</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1">#ax.axes.set_title(&quot;Title&quot;,fontsize=50)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">COL_METRIC</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">COL_VALUE</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="1---Understanding-the-Data">
<h2>1 - Understanding the Data<a class="headerlink" href="#1---Understanding-the-Data" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">()</span>
<span class="n">label_col</span> <span class="o">=</span> <span class="s2">&quot;Class&quot;</span>
<span class="n">df</span><span class="p">[</span><span class="n">label_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;recurrence-events&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;no-recurrence-events&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Class</th>
      <th>age</th>
      <th>menopause</th>
      <th>tumor-size</th>
      <th>inv-nodes</th>
      <th>node-caps</th>
      <th>deg-malig</th>
      <th>breast</th>
      <th>breast-quad</th>
      <th>irradiat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>30-39</td>
      <td>premeno</td>
      <td>30-34</td>
      <td>0-2</td>
      <td>no</td>
      <td>3</td>
      <td>left</td>
      <td>left_low</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>40-49</td>
      <td>premeno</td>
      <td>20-24</td>
      <td>0-2</td>
      <td>no</td>
      <td>2</td>
      <td>right</td>
      <td>right_up</td>
      <td>no</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>40-49</td>
      <td>premeno</td>
      <td>20-24</td>
      <td>0-2</td>
      <td>no</td>
      <td>2</td>
      <td>left</td>
      <td>left_low</td>
      <td>no</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>60-69</td>
      <td>ge40</td>
      <td>15-19</td>
      <td>0-2</td>
      <td>no</td>
      <td>2</td>
      <td>right</td>
      <td>left_up</td>
      <td>no</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>40-49</td>
      <td>premeno</td>
      <td>0-4</td>
      <td>0-2</td>
      <td>no</td>
      <td>2</td>
      <td>right</td>
      <td>right_low</td>
      <td>no</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>281</th>
      <td>1</td>
      <td>30-39</td>
      <td>premeno</td>
      <td>30-34</td>
      <td>0-2</td>
      <td>no</td>
      <td>2</td>
      <td>left</td>
      <td>left_up</td>
      <td>no</td>
    </tr>
    <tr>
      <th>282</th>
      <td>1</td>
      <td>30-39</td>
      <td>premeno</td>
      <td>20-24</td>
      <td>0-2</td>
      <td>no</td>
      <td>3</td>
      <td>left</td>
      <td>left_up</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>283</th>
      <td>1</td>
      <td>60-69</td>
      <td>ge40</td>
      <td>20-24</td>
      <td>0-2</td>
      <td>no</td>
      <td>1</td>
      <td>right</td>
      <td>left_up</td>
      <td>no</td>
    </tr>
    <tr>
      <th>284</th>
      <td>1</td>
      <td>40-49</td>
      <td>ge40</td>
      <td>30-34</td>
      <td>3-5</td>
      <td>no</td>
      <td>3</td>
      <td>left</td>
      <td>left_low</td>
      <td>no</td>
    </tr>
    <tr>
      <th>285</th>
      <td>1</td>
      <td>50-59</td>
      <td>ge40</td>
      <td>30-34</td>
      <td>3-5</td>
      <td>no</td>
      <td>3</td>
      <td>left</td>
      <td>left_low</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
<p>286 rows × 10 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 286 entries, 0 to 285
Data columns (total 10 columns):
 #   Column       Non-Null Count  Dtype
---  ------       --------------  -----
 0   Class        286 non-null    int64
 1   age          286 non-null    object
 2   menopause    286 non-null    object
 3   tumor-size   286 non-null    object
 4   inv-nodes    286 non-null    object
 5   node-caps    278 non-null    object
 6   deg-malig    286 non-null    int64
 7   breast       286 non-null    object
 8   breast-quad  285 non-null    object
 9   irradiat     286 non-null    object
dtypes: int64(2), object(8)
memory usage: 22.5+ KB
</pre></div></div>
</div>
</section>
<section id="2---Efficiency-of-Different-Classes-from-raimitigations.dataprocessing-lib">
<h2>2 - Efficiency of Different Classes from raimitigations.dataprocessing lib<a class="headerlink" href="#2---Efficiency-of-Different-Classes-from-raimitigations.dataprocessing-lib" title="Permalink to this heading"></a></h2>
<p>In this section we will test different preprocessing classes provided by the <strong>dataprocessing</strong> class. We will always compare the model’s performance when trained with the original dataset and when trained with a preprocessed dataset. Note that, as previously mentioned, for each different version of the dataset used (with different preprocessing steps), we train different versions of the same model using different train/test splits and then record the mean and standard deviation of the observed
metrics (ROC AUC, Precision, Recall, and F1 score).</p>
<section id="KNN-Model">
<h3>KNN Model<a class="headerlink" href="#KNN-Model" title="Permalink to this heading"></a></h3>
<p>Let’s start by fixing the learning algorithm/model to be the K-Nearest Neighbors (KNN).</p>
<section id="Feature-Selection">
<h4>Feature Selection<a class="headerlink" href="#Feature-Selection" title="Permalink to this heading"></a></h4>
<p>Here we compare 4 training pipelines, all of them using the KNN model, as previously mentioned: - Baseline dataset (only encoding and imputation applied) - Baseline dataset + removal of highly correlated features (using the <strong>CorrelatedFeatures</strong> class) - Baseline dataset + feature selection using Sequential Backward Selection (using the <strong>SeqFeatSelection</strong> class) - Baseline dataset + feature selection using the CatBoost model feature weights (using the <strong>CatBoostSelection</strong> class).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MODEL_NAME</span> <span class="o">=</span> <span class="s2">&quot;knn&quot;</span>

<span class="n">result_base</span> <span class="o">=</span> <span class="n">test_base</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">result_base</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">)</span>

<span class="n">result_cor</span> <span class="o">=</span> <span class="n">test_corr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">result_cor</span><span class="p">,</span> <span class="s2">&quot;Corr.&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_smote</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="n">SEQ_BWD</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;Seq.Bwd.&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_smote</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="n">CATBOOST</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;CatBoost&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
../../errorsmitigation/dataprocessing/utils_model.py:65: RuntimeWarning: invalid value encountered in true_divide
  fscore = (2 * precision * recall) / (precision + recall)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_results</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/dataprocessing_notebooks_case_study_case1_stat_7_0.png" src="../../../_images/dataprocessing_notebooks_case_study_case1_stat_7_0.png" />
</div>
</div>
<p>Some important observations regarding the above graph: - It seems that by removing highly correlated features (orange bar) results in slightly better results. However, if we check the list of pairs of correlated features in this dataset (check the JSON file <strong>corr_json/c1_corr.json</strong>), we can see that there are none. This means that no features were removed using <strong>CorrelatedFeatures</strong> class, which means that the orange results were generated by the exact same steps as the blue one (baseline).
The increased F1 score for the orange experiment is a mere coincidence. This is also expected, since the standard deviation error is relatively high (the small black lines on top of each bar). The high standard deviation is also expected because of the small size of the dataset, which makes the train/test split even more important; - The other two feature selection experiments (green and red bars) didn’t provide any improvements with a statistical significance.</p>
</section>
<section id="Artificial-Instances---SMOTE">
<h4>Artificial Instances - SMOTE<a class="headerlink" href="#Artificial-Instances---SMOTE" title="Permalink to this heading"></a></h4>
<p>The next set of experiments aims to test the efficiency of the SMOTE and TOMEK Links (over and under sampling, respectively). Here we perform 3 experiments: - Baseline dataset (only encoding and imputation applied) - Baseline dataset + over sampling (using the <strong>Rebalance</strong> class) - Baseline dataset + over and under sampling (using the <strong>Rebalance</strong> class).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MODEL_NAME</span> <span class="o">=</span> <span class="s2">&quot;knn&quot;</span>
<span class="n">result_base</span> <span class="o">=</span> <span class="n">test_base</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">result_base</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_smote</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">under</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;SM&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_smote</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">under</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;SM+TK&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_results</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/dataprocessing_notebooks_case_study_case1_stat_11_0.png" src="../../../_images/dataprocessing_notebooks_case_study_case1_stat_11_0.png" />
</div>
</div>
</section>
<section id="Artificial-Instances---CTGAN">
<h4>Artificial Instances - CTGAN<a class="headerlink" href="#Artificial-Instances---CTGAN" title="Permalink to this heading"></a></h4>
<p>Instead of doing over sampling using SMOTE and its variations, we can create artificial instances of the minority class using the CTGAN. Here we perform 3 experiments: - Baseline dataset (only encoding and imputation applied) - Baseline dataset + over sampling with CTGAN (using the <strong>Synthesizer</strong> class) with a minority/majority ration of 0.6 - Baseline dataset + over sampling with CTGAN (using the <strong>Synthesizer</strong> class) with a minority/majority ration of 0.9</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MODEL_NAME</span> <span class="o">=</span> <span class="s2">&quot;knn&quot;</span>
<span class="n">result_base</span> <span class="o">=</span> <span class="n">test_base</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">result_base</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_ctgan_first</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="s2">&quot;1_1.pkl&quot;</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;CTGAN 0.6&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_ctgan_first</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="s2">&quot;1_2.pkl&quot;</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;CTGAN 0.9&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:146: ConvergenceWarning: Number of distinct clusters (3) found smaller than n_clusters (10). Possibly due to duplicate points in X.
  .fit(X)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_results</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/dataprocessing_notebooks_case_study_case1_stat_14_0.png" src="../../../_images/dataprocessing_notebooks_case_study_case1_stat_14_0.png" />
</div>
</div>
</section>
</section>
<section id="XGBoost">
<h3>XGBoost<a class="headerlink" href="#XGBoost" title="Permalink to this heading"></a></h3>
<section id="id1">
<h4>Feature Selection<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MODEL_NAME</span> <span class="o">=</span> <span class="s2">&quot;xgb&quot;</span>

<span class="n">result_base</span> <span class="o">=</span> <span class="n">test_base</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">result_base</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">)</span>

<span class="n">result_cor</span> <span class="o">=</span> <span class="n">test_corr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">result_cor</span><span class="p">,</span> <span class="s2">&quot;Corr.&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_smote</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="n">SEQ_BWD</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;Seq.Bwd.&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_smote</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="n">CATBOOST</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;CatBoost&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_results</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/dataprocessing_notebooks_case_study_case1_stat_17_0.png" src="../../../_images/dataprocessing_notebooks_case_study_case1_stat_17_0.png" />
</div>
</div>
</section>
<section id="id2">
<h4>Artificial Instances - SMOTE<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_base</span> <span class="o">=</span> <span class="n">test_base</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">result_base</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_smote</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">under</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;SM&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_smote</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">under</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;SM+TK&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_results</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/dataprocessing_notebooks_case_study_case1_stat_20_0.png" src="../../../_images/dataprocessing_notebooks_case_study_case1_stat_20_0.png" />
</div>
</div>
</section>
<section id="id3">
<h4>Artificial Instances - CTGAN<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_base</span> <span class="o">=</span> <span class="n">test_base</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">result_base</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_ctgan_first</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="s2">&quot;1_3.pkl&quot;</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;CTGAN 0.6&quot;</span><span class="p">)</span>

<span class="n">restult_fs</span> <span class="o">=</span> <span class="n">test_ctgan_first</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_col</span><span class="p">,</span> <span class="n">N_EXEC</span><span class="p">,</span> <span class="n">MODEL_NAME</span><span class="p">,</span> <span class="n">rcorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feat_sel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">art_str</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="s2">&quot;1_4.pkl&quot;</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">add_results_df</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">restult_fs</span><span class="p">,</span> <span class="s2">&quot;CTGAN 0.9&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:146: ConvergenceWarning: Number of distinct clusters (3) found smaller than n_clusters (10). Possibly due to duplicate points in X.
  .fit(X)
/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:146: ConvergenceWarning: Number of distinct clusters (3) found smaller than n_clusters (10). Possibly due to duplicate points in X.
  .fit(X)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_results</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/dataprocessing_notebooks_case_study_case1_stat_23_0.png" src="../../../_images/dataprocessing_notebooks_case_study_case1_stat_23_0.png" />
</div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="case3.html" class="btn btn-neutral float-left" title="Case Study 3" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="case2_stat.html" class="btn btn-neutral float-right" title="Case Study 2 - Multiple Runs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Microsoft.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>