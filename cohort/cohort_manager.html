<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CohortManager &mdash; Responsible AI Mitigations  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-gallery.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Managing cohorts" href="../notebooks/cohort/cohort_manager.html" />
    <link rel="prev" title="CohortHandler" href="cohort_handler.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Responsible AI Mitigations
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install_guide.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integration_to_libs.html">How this library works with the Responsible AI Toolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery.html">Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dataprocessing/intro.html">DataProcessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../databalanceanalysis/intro.html">DataBalanceAnalysis</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="intro.html">Cohort</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="intro.html#api">API</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="cohort.html">Cohort</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="cohort_definition.html">CohortDefinition</a></li>
<li class="toctree-l4"><a class="reference internal" href="cohort_handler.html">CohortHandler</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">CohortManager</a></li>
<li class="toctree-l4"><a class="reference internal" href="decoupled_class.html">DecoupledClass</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html">Cohort Utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/utils.html">Utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Responsible AI Mitigations</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API reference</a></li>
          <li class="breadcrumb-item"><a href="cohort.html">Cohort</a></li>
      <li class="breadcrumb-item active">CohortManager</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com//microsoft/responsible-ai-toolbox-mitigations/blob/main/docs/cohort/cohort_manager.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cohortmanager">
<span id="cohort-manager"></span><h1>CohortManager<a class="headerlink" href="#cohortmanager" title="Permalink to this heading"></a></h1>
<p>The <strong>CohortManager</strong> allows the application of different data processing pipelines over each cohort. Also allows the creation and
filtering of multiple cohorts using a simple interface. Finally, allows the creation of different estimators for each cohort using
the <code class="docutils literal notranslate"><span class="pre">.predict()</span></code> and <code class="docutils literal notranslate"><span class="pre">predict_proba()</span></code> interfaces. This class uses the <a class="reference internal" href="cohort_definition.html#cohort-def"><span class="std std-ref">cohort.CohortDefinition</span></a>
internally in order to create, filter, and manipulate multiple cohorts. There are multiple ways of using the
<a class="reference internal" href="#cohort-manager"><span class="std std-ref">cohort.CohortManager</span></a> class when building a pipeline, and these different scenarios are summarized in following
figure.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/scenarios.jpg"><img alt="Balancing over cohorts" src="../_images/scenarios.jpg" style="width: 686.0px; height: 425.40000000000003px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Figure 1 - The CohortManager class can be used in different ways to target mitigations to different cohorts. The main differences
between these scenarios consist on whether the same or different type of data mitigation is applied to the cohort data, and whether
a single or separate models will be trained for different cohorts. Depending on these choices, CohortManager will take care of
slicing the data accordingly, applying the specified data mitigation strategy, merging the data back, and retraining the model(s).</em></span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The <strong>Cohort Manager - Scenarios and Examples</strong> notebook, located in <code class="docutils literal notranslate"><span class="pre">notebooks/cohort/cohort_manager_scenarios.ipynb</span></code> and listed in
the <strong>Examples</strong> section below, shows how each of these scenarios can be implemented through simple code snippets.</p>
<dl class="py class">
<dt class="sig sig-object py" id="raimitigations.cohort.CohortManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">raimitigations.cohort.</span></span><span class="sig-name descname"><span class="pre">CohortManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform_pipe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_def</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_json_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#raimitigations.cohort.CohortManager" title="Permalink to this definition"></a></dt>
<dd><p>Concrete class that manages multiple cohort pipelines that are
applied using the <code class="docutils literal notranslate"><span class="pre">fit()</span></code>, <code class="docutils literal notranslate"><span class="pre">transform()</span></code>, <code class="docutils literal notranslate"><span class="pre">fit_resample()</span></code>,
<code class="docutils literal notranslate"><span class="pre">predict()</span></code>, and <code class="docutils literal notranslate"><span class="pre">predict_proba()</span></code> interfaces. The <code class="docutils literal notranslate"><span class="pre">CohortManager</span></code>
uses multiple <code class="docutils literal notranslate"><span class="pre">CohortDefinition</span></code> objects to control the filters
of each cohort, while using transformation pipelines to control
which transformations should be applied to each cohort.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transform_pipe</strong> – <p>the transformation pipeline to be used for each
cohort. There are different ways to present this parameter:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>An empty list or None:</strong> in this case, the <code class="docutils literal notranslate"><span class="pre">CohortManager</span></code>
won’t apply any transformations over the dataset. The <code class="docutils literal notranslate"><span class="pre">transform()</span></code>
method will simply return the dataset provided;</p></li>
<li><p><strong>A single transformer:</strong> in this case, this single transformer is
placed in a list (a list with a single transformer), which is then
replicated such that each cohort has its own list of transformations
(pipeline);</p></li>
<li><p><strong>A list of transformers:</strong> in this case, this pipeline is replicated
for each cohort;</p></li>
<li><p><strong>A list of pipelines:</strong> a list of pipelines is basically a list of
lists of transformations. In this case, the list of pipelines should have
one pipeline for each cohort created, that is, the length of the
<code class="docutils literal notranslate"><span class="pre">transform_pipe</span></code> parameter should be the same as the number of cohorts
created. The pipelines will be assigned to each cohort following the same
order as the <code class="docutils literal notranslate"><span class="pre">cohort_def</span></code> parameter (depicted in the following example);</p></li>
</ol>
</div></blockquote>
</p></li>
<li><p><strong>cohort_def</strong> – a list of cohort definitions or a dictionary of cohort definitions.
A cohort condition is the same variable received by the <code class="docutils literal notranslate"><span class="pre">cohort_definition</span></code> parameter
of the <code class="docutils literal notranslate"><span class="pre">CohortDefinition</span></code> class. When using a list of cohort definitions, the cohorts
will be named automatically. For the dictionary of cohort definitions, the key used represents
the cohort’s name, and the value assigned to each key is given by that cohort’s conditions.
This parameter can’t be used together with the <code class="docutils literal notranslate"><span class="pre">cohort_col</span></code> parameter. Only one these two
parameters must be used at a time. This parameter is ignored if <code class="docutils literal notranslate"><span class="pre">cohort_json_files</span></code> is
provided;</p></li>
<li><p><strong>cohort_col</strong> – a list of column names or indices, from which one cohort is created for each
unique combination of values for these columns. This parameter can’t be used together with
the <code class="docutils literal notranslate"><span class="pre">cohort_def</span></code> parameter. Only one these two parameters must be used at a time. This
parameter is ignored if <code class="docutils literal notranslate"><span class="pre">cohort_json_files</span></code> is provided;</p></li>
<li><p><strong>cohort_json_files</strong> – a list with the name of the JSON files that contains the definition
of each cohort. Each cohort is saved in a single JSON file, so the length of the
<code class="docutils literal notranslate"><span class="pre">cohort_json_files</span></code> should be equal to the number of cohorts to be used.</p></li>
<li><p><strong>df</strong> – the data frame to be used during the fit method.
This data frame must contain all the features, including the label
column (specified in the  <code class="docutils literal notranslate"><span class="pre">label_col</span></code> parameter). This parameter is
mandatory if  <code class="docutils literal notranslate"><span class="pre">label_col</span></code> is also provided. The user can also provide
this dataset (along with the  <code class="docutils literal notranslate"><span class="pre">label_col</span></code>) when calling the <a class="reference internal" href="#raimitigations.cohort.CohortManager.fit" title="raimitigations.cohort.CohortManager.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>
method. If df is provided during the class instantiation, it is not
necessary to provide it again when calling <a class="reference internal" href="#raimitigations.cohort.CohortManager.fit" title="raimitigations.cohort.CohortManager.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>. It is also possible
to use the  <code class="docutils literal notranslate"><span class="pre">X</span></code> and  <code class="docutils literal notranslate"><span class="pre">y</span></code> instead of <code class="docutils literal notranslate"><span class="pre">df</span></code> and <code class="docutils literal notranslate"><span class="pre">label_col</span></code>, although it is
mandatory to pass the pair of parameters (X,y) or (df, label_col) either
during the class instantiation or during the <a class="reference internal" href="#raimitigations.cohort.CohortManager.fit" title="raimitigations.cohort.CohortManager.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> method;</p></li>
<li><p><strong>label_col</strong> – the name or index of the label column. This parameter is
mandatory if <code class="docutils literal notranslate"><span class="pre">df</span></code> is provided;</p></li>
<li><p><strong>X</strong> – contains only the features of the original dataset, that is, does not
contain the label column. This is useful if the user has already separated
the features from the label column prior to calling this class. This parameter
is mandatory if <code class="docutils literal notranslate"><span class="pre">y</span></code> is provided;</p></li>
<li><p><strong>y</strong> – contains only the label column of the original dataset.
This parameter is mandatory if <code class="docutils literal notranslate"><span class="pre">X</span></code> is provided;</p></li>
<li><p><strong>verbose</strong> – indicates whether internal messages should be printed or not.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="raimitigations.cohort.CohortManager.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#raimitigations.cohort.CohortManager.fit" title="Permalink to this definition"></a></dt>
<dd><p>Calls the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method of all transformers in all pipelines. Each cohort
has its own pipeline. This way, the following steps are executed: (i) iterate
over each cohort, (ii) filter the dataset (<code class="docutils literal notranslate"><span class="pre">X</span></code> or <code class="docutils literal notranslate"><span class="pre">df</span></code>) using each cohort’s
filter, (iii) cycle through each of the transformers in the cohort’s pipeline
and call the transformer’s <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method, (iv) after fitting the transformer,
call its <code class="docutils literal notranslate"><span class="pre">transform()</span></code> method to get the updated subset, which is then used in
the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> call of the following transformer. Finally, check if all instances
belong to only a single cohort.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – contains only the features of the original dataset, that is, does not
contain the label column;</p></li>
<li><p><strong>y</strong> – contains only the label column of the original dataset;</p></li>
<li><p><strong>df</strong> – the full dataset;</p></li>
<li><p><strong>label_col</strong> – the name or index of the label column;</p></li>
</ul>
</dd>
</dl>
<p>Check the documentation of the _set_df_mult method (DataProcessing class)
for more information on how these parameters work.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="raimitigations.cohort.CohortManager.fit_resample">
<span class="sig-name descname"><span class="pre">fit_resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebalance_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#raimitigations.cohort.CohortManager.fit_resample" title="Permalink to this definition"></a></dt>
<dd><p>Calls the <code class="docutils literal notranslate"><span class="pre">fit_resample()</span></code> method of all transformers in all pipelines. Each
cohort has its own pipeline. This way, the following steps are executed:
(i) iterate over each cohort, (ii) filter the dataset (<code class="docutils literal notranslate"><span class="pre">X</span></code> or <code class="docutils literal notranslate"><span class="pre">df</span></code>) using
each cohort’s filter, (iii) cycle through each of the transformers in the cohort’s
pipeline and call the transformer’s <code class="docutils literal notranslate"><span class="pre">fit_resample()</span></code> method, (iv) after resampling
using the current transformer, save the new subset and use it when calling the
<code class="docutils literal notranslate"><span class="pre">fit_resample()</span></code> of the following transformer. Finally, check if all instances
belong to only a single cohort.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – contains only the features of the original dataset, that is, does
not contain the column used for rebalancing. This is useful if the user has
already separated the features from the label column prior to calling this
class. This parameter is mandatory if  <code class="docutils literal notranslate"><span class="pre">y</span></code> is provided;</p></li>
<li><p><strong>y</strong> – contains only the rebalance column of the original dataset. The rebalance
operation is executed based on the data distribution of this column. This parameter
is mandatory if  <code class="docutils literal notranslate"><span class="pre">X</span></code> is provided;</p></li>
<li><p><strong>df</strong> – the dataset to be rebalanced, which is used during the <a class="reference internal" href="#raimitigations.cohort.CohortManager.fit" title="raimitigations.cohort.CohortManager.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> method.
This data frame must contain all the features, including the rebalance
column (specified in the  <code class="docutils literal notranslate"><span class="pre">rebalance_col</span></code> parameter). This parameter is
mandatory if  <code class="docutils literal notranslate"><span class="pre">rebalance_col</span></code> is also provided. The user can also provide
this dataset (along with the  <code class="docutils literal notranslate"><span class="pre">rebalance_col</span></code>) when calling the <a class="reference internal" href="#raimitigations.cohort.CohortManager.fit" title="raimitigations.cohort.CohortManager.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>
method. If <code class="docutils literal notranslate"><span class="pre">df</span></code> is provided during the class instantiation, it is not
necessary to provide it again when calling <a class="reference internal" href="#raimitigations.cohort.CohortManager.fit" title="raimitigations.cohort.CohortManager.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>. It is also possible
to use the  <code class="docutils literal notranslate"><span class="pre">X</span></code> and  <code class="docutils literal notranslate"><span class="pre">y</span></code> instead of  <code class="docutils literal notranslate"><span class="pre">df</span></code> and  <code class="docutils literal notranslate"><span class="pre">rebalance_col</span></code>, although it is
mandatory to pass the pair of parameters (X,y) or (df, rebalance_col) either
during the class instantiation or during the <a class="reference internal" href="#raimitigations.cohort.CohortManager.fit" title="raimitigations.cohort.CohortManager.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> method;</p></li>
<li><p><strong>rebalance_col</strong> – the name or index of the column used to do the rebalance
operation. This parameter is mandatory if  <code class="docutils literal notranslate"><span class="pre">df</span></code> is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resampled dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="raimitigations.cohort.CohortManager.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#raimitigations.cohort.CohortManager.predict" title="Permalink to this definition"></a></dt>
<dd><p>Calls the <code class="docutils literal notranslate"><span class="pre">transform()</span></code> method of all transformers in all pipelines, followed
by the <code class="docutils literal notranslate"><span class="pre">predict()</span></code> method for the estimator (which is always the last object
in the pipeline).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – contains only the features of the dataset to be transformed;</p></li>
<li><p><strong>split_pred</strong> – if True, return a dictionary with the predictions
for each cohort. If False, return a single predictions array;</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an array with the predictions of all instances of the dataset, built from the
predictions of each cohort, or a dictionary with the predictions for each cohort;</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray or dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="raimitigations.cohort.CohortManager.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#raimitigations.cohort.CohortManager.predict_proba" title="Permalink to this definition"></a></dt>
<dd><p>Calls the <code class="docutils literal notranslate"><span class="pre">transform()</span></code> method of all transformers in all pipelines, followed
by the <code class="docutils literal notranslate"><span class="pre">predict_proba()</span></code> method for the estimator (which is always the last object
in the pipeline).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – contains only the features of the dataset to be transformed;</p></li>
<li><p><strong>split_pred</strong> – if True, return a dictionary with the predictions
for each cohort. If False, return a single predictions array;</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an array with the predictions of all instances of the dataset, built from the
predictions of each cohort, or a dictionary with the predictions for each cohort;</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray or dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="raimitigations.cohort.CohortManager.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#raimitigations.cohort.CohortManager.transform" title="Permalink to this definition"></a></dt>
<dd><p>Calls the <code class="docutils literal notranslate"><span class="pre">transform()</span></code> method of all transformers in all pipelines. Each cohort
has its own pipeline. This way, the following steps are executed: (i) iterate
over each cohort, (ii) filter the dataset <code class="docutils literal notranslate"><span class="pre">X</span></code> using each cohort’s filter, (iii)
cycle through each of the transformers in the cohort’s pipeline and call the
transformer’s <code class="docutils literal notranslate"><span class="pre">transform()</span></code> method, which returns a new transformed subset,
that is then used in the <code class="docutils literal notranslate"><span class="pre">transform()</span></code> call of the following transformer.
Finally, check if all instances belong to only a single cohort, and merge all cohort
subsets into a single dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – contains only the features of the dataset to be transformed;</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataset containing the transformed instances of all cohorts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p class="rubric">Class Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-a346f30c2ea2c2081eb75ab3c53240ef059a5370.png" alt="Inheritance diagram of raimitigations.cohort.CohortManager" usemap="#inheritance6082ae817f" class="inheritance graphviz" /></div>
<map id="inheritance6082ae817f" name="inheritance6082ae817f">
<area shape="rect" id="node3" href="../dataprocessing/dataprocessing.html#raimitigations.dataprocessing.DataProcessing" target="_top" title="Base class for all classes present in the dataprocessing module" alt="" coords="125,5,248,31"/>
<area shape="rect" id="node2" href="cohort_handler.html#raimitigations.cohort.CohortHandler" target="_top" title="Abstract class that manages multiple cohorts." alt="" coords="296,5,412,31"/>
<area shape="rect" id="node4" href="#raimitigations.cohort.CohortManager" target="_top" title="Concrete class that manages multiple cohort pipelines that are" alt="" coords="460,5,583,31"/>
</map><section id="examples">
<span id="cohort-manager-ex"></span><h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<div class="nbsphinx-gallery">
<a class="reference internal" href="../notebooks/cohort/cohort_manager.html">
  <div><img alt="" src="../_images/notebooks_cohort_cohort_manager_68_1.png"></div>
  <div>Managing cohorts</div>
</a>
<a class="reference internal" href="../notebooks/cohort/cohort_manager_scenarios.html">
  <div><img alt="" src="../_static/nbsphinx-no-thumbnail.svg"></div>
  <div>Cohort Manager - Scenarios and Examples</div>
</a>
<a class="reference internal" href="../notebooks/cohort/case_study/case_1.html">
  <div><img alt="" src="../_static/nbsphinx-no-thumbnail.svg"></div>
  <div>Cohort Case Study 1</div>
</a>
<a class="reference internal" href="../notebooks/cohort/case_study/case_1_rebalance.html">
  <div><img alt="" src="../_images/notebooks_cohort_case_study_case_1_rebalance_19_0.png"></div>
  <div>Cohort Case Study 1 - Rebalancing</div>
</a>
<a class="reference internal" href="../notebooks/cohort/case_study/case_1_dashboard.html">
  <div><img alt="" src="../_static/nbsphinx-no-thumbnail.svg"></div>
  <div>Cohort Case Study 1 - Using RAI ErrorAnalysis</div>
</a>
<a class="reference internal" href="../notebooks/cohort/case_study/case_2.html">
  <div><img alt="" src="../_images/notebooks_cohort_case_study_case_2_28_0.png"></div>
  <div>Cohort Case Study 2</div>
</a>
<a class="reference internal" href="../notebooks/cohort/case_study/case_3.html">
  <div><img alt="" src="../_static/nbsphinx-no-thumbnail.svg"></div>
  <div>Cohort Case Study 3</div>
</a>
<a class="reference internal" href="../notebooks/cohort/case_study/integration_raiwidgets.html">
  <div><img alt="" src="../_static/nbsphinx-no-thumbnail.svg"></div>
  <div>Moving Cohorts from raimitigations to raiwidgets (and vice versa)</div>
</a>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cohort_handler.html" class="btn btn-neutral float-left" title="CohortHandler" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../notebooks/cohort/cohort_manager.html" class="btn btn-neutral float-right" title="Managing cohorts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Microsoft.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>