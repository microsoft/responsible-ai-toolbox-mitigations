{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Using Pipelines\n",
    "\n",
    "The **dataprocessing** library works with the **Pipeline** class from SKLearn. In this notebook, we show a few examples of how to use pipelines with transformers from the **dataprocessing** library."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "from typing import Union\n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.svm import SVC\n",
    "from sklearn.cluster import KMeans\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.impute import SimpleImputer\n",
    "from sklearn.pipeline import Pipeline\n",
    "import uci_dataset as database\n",
    "\n",
    "import raimitigations.dataprocessing as dp"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In this notebook, we'll use the thyroid disease dataset. Let's load this dataset and take a look at it:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sick-euthyroid</th>\n",
       "      <th>age</th>\n",
       "      <th>sex</th>\n",
       "      <th>on_thyroxine</th>\n",
       "      <th>query_on_thyroxine</th>\n",
       "      <th>on_antithyroid_medication</th>\n",
       "      <th>thyroid_surgery</th>\n",
       "      <th>query_hypothyroid</th>\n",
       "      <th>query_hyperthyroid</th>\n",
       "      <th>pregnant</th>\n",
       "      <th>...</th>\n",
       "      <th>T3_measured</th>\n",
       "      <th>T3</th>\n",
       "      <th>TT4_measured</th>\n",
       "      <th>TT4</th>\n",
       "      <th>T4U_measured</th>\n",
       "      <th>T4U</th>\n",
       "      <th>FTI_measured</th>\n",
       "      <th>FTI</th>\n",
       "      <th>TBG_measured</th>\n",
       "      <th>TBG</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>72.0</td>\n",
       "      <td>M</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>1.0</td>\n",
       "      <td>y</td>\n",
       "      <td>83.0</td>\n",
       "      <td>y</td>\n",
       "      <td>0.95</td>\n",
       "      <td>y</td>\n",
       "      <td>87.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>45.0</td>\n",
       "      <td>F</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>1.0</td>\n",
       "      <td>y</td>\n",
       "      <td>82.0</td>\n",
       "      <td>y</td>\n",
       "      <td>0.73</td>\n",
       "      <td>y</td>\n",
       "      <td>112.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>64.0</td>\n",
       "      <td>F</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>1.0</td>\n",
       "      <td>y</td>\n",
       "      <td>101.0</td>\n",
       "      <td>y</td>\n",
       "      <td>0.82</td>\n",
       "      <td>y</td>\n",
       "      <td>123.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>56.0</td>\n",
       "      <td>M</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>0.8</td>\n",
       "      <td>y</td>\n",
       "      <td>76.0</td>\n",
       "      <td>y</td>\n",
       "      <td>0.77</td>\n",
       "      <td>y</td>\n",
       "      <td>99.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>78.0</td>\n",
       "      <td>F</td>\n",
       "      <td>t</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>t</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>0.3</td>\n",
       "      <td>y</td>\n",
       "      <td>87.0</td>\n",
       "      <td>y</td>\n",
       "      <td>0.95</td>\n",
       "      <td>y</td>\n",
       "      <td>91.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3158</th>\n",
       "      <td>0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>F</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>1.2</td>\n",
       "      <td>y</td>\n",
       "      <td>76.0</td>\n",
       "      <td>y</td>\n",
       "      <td>0.90</td>\n",
       "      <td>y</td>\n",
       "      <td>84.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3159</th>\n",
       "      <td>0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>F</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>1.8</td>\n",
       "      <td>y</td>\n",
       "      <td>126.0</td>\n",
       "      <td>y</td>\n",
       "      <td>1.02</td>\n",
       "      <td>y</td>\n",
       "      <td>124.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3160</th>\n",
       "      <td>0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>F</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>1.7</td>\n",
       "      <td>y</td>\n",
       "      <td>86.0</td>\n",
       "      <td>y</td>\n",
       "      <td>0.91</td>\n",
       "      <td>y</td>\n",
       "      <td>95.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3161</th>\n",
       "      <td>0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>F</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>1.8</td>\n",
       "      <td>y</td>\n",
       "      <td>99.0</td>\n",
       "      <td>y</td>\n",
       "      <td>1.01</td>\n",
       "      <td>y</td>\n",
       "      <td>98.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3162</th>\n",
       "      <td>0</td>\n",
       "      <td>56.0</td>\n",
       "      <td>F</td>\n",
       "      <td>t</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>f</td>\n",
       "      <td>...</td>\n",
       "      <td>y</td>\n",
       "      <td>1.8</td>\n",
       "      <td>y</td>\n",
       "      <td>139.0</td>\n",
       "      <td>y</td>\n",
       "      <td>0.97</td>\n",
       "      <td>y</td>\n",
       "      <td>143.0</td>\n",
       "      <td>n</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3163 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      sick-euthyroid   age sex on_thyroxine query_on_thyroxine  \\\n",
       "0                  1  72.0   M            f                  f   \n",
       "1                  1  45.0   F            f                  f   \n",
       "2                  1  64.0   F            f                  f   \n",
       "3                  1  56.0   M            f                  f   \n",
       "4                  1  78.0   F            t                  f   \n",
       "...              ...   ...  ..          ...                ...   \n",
       "3158               0  40.0   F            f                  f   \n",
       "3159               0  69.0   F            f                  f   \n",
       "3160               0  58.0   F            f                  f   \n",
       "3161               0  29.0   F            f                  f   \n",
       "3162               0  56.0   F            t                  f   \n",
       "\n",
       "     on_antithyroid_medication thyroid_surgery query_hypothyroid  \\\n",
       "0                            f               f                 f   \n",
       "1                            f               f                 f   \n",
       "2                            f               f                 f   \n",
       "3                            f               f                 f   \n",
       "4                            f               f                 t   \n",
       "...                        ...             ...               ...   \n",
       "3158                         f               f                 f   \n",
       "3159                         f               f                 f   \n",
       "3160                         f               f                 f   \n",
       "3161                         f               f                 f   \n",
       "3162                         f               f                 f   \n",
       "\n",
       "     query_hyperthyroid pregnant  ... T3_measured   T3 TT4_measured    TT4  \\\n",
       "0                     f        f  ...           y  1.0            y   83.0   \n",
       "1                     f        f  ...           y  1.0            y   82.0   \n",
       "2                     f        f  ...           y  1.0            y  101.0   \n",
       "3                     f        f  ...           y  0.8            y   76.0   \n",
       "4                     f        f  ...           y  0.3            y   87.0   \n",
       "...                 ...      ...  ...         ...  ...          ...    ...   \n",
       "3158                  f        f  ...           y  1.2            y   76.0   \n",
       "3159                  f        f  ...           y  1.8            y  126.0   \n",
       "3160                  f        f  ...           y  1.7            y   86.0   \n",
       "3161                  f        f  ...           y  1.8            y   99.0   \n",
       "3162                  f        f  ...           y  1.8            y  139.0   \n",
       "\n",
       "     T4U_measured   T4U FTI_measured    FTI TBG_measured  TBG  \n",
       "0               y  0.95            y   87.0            n  NaN  \n",
       "1               y  0.73            y  112.0            n  NaN  \n",
       "2               y  0.82            y  123.0            n  NaN  \n",
       "3               y  0.77            y   99.0            n  NaN  \n",
       "4               y  0.95            y   91.0            n  NaN  \n",
       "...           ...   ...          ...    ...          ...  ...  \n",
       "3158            y  0.90            y   84.0            n  NaN  \n",
       "3159            y  1.02            y  124.0            n  NaN  \n",
       "3160            y  0.91            y   95.0            n  NaN  \n",
       "3161            y  1.01            y   98.0            n  NaN  \n",
       "3162            y  0.97            y  143.0            n  NaN  \n",
       "\n",
       "[3163 rows x 26 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = database.load_thyroid_disease()\n",
    "label_col = \"sick-euthyroid\"\n",
    "df[label_col] = df[label_col].replace({\"sick-euthyroid\": 1, \"negative\": 0})\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 3163 entries, 0 to 3162\n",
      "Data columns (total 26 columns):\n",
      " #   Column                     Non-Null Count  Dtype  \n",
      "---  ------                     --------------  -----  \n",
      " 0   sick-euthyroid             3163 non-null   int64  \n",
      " 1   age                        2717 non-null   float64\n",
      " 2   sex                        3090 non-null   object \n",
      " 3   on_thyroxine               3163 non-null   object \n",
      " 4   query_on_thyroxine         3163 non-null   object \n",
      " 5   on_antithyroid_medication  3163 non-null   object \n",
      " 6   thyroid_surgery            3163 non-null   object \n",
      " 7   query_hypothyroid          3163 non-null   object \n",
      " 8   query_hyperthyroid         3163 non-null   object \n",
      " 9   pregnant                   3163 non-null   object \n",
      " 10  sick                       3163 non-null   object \n",
      " 11  tumor                      3163 non-null   object \n",
      " 12  lithium                    3163 non-null   object \n",
      " 13  goitre                     3163 non-null   object \n",
      " 14  TSH_measured               3163 non-null   object \n",
      " 15  TSH                        2695 non-null   float64\n",
      " 16  T3_measured                3163 non-null   object \n",
      " 17  T3                         2468 non-null   float64\n",
      " 18  TT4_measured               3163 non-null   object \n",
      " 19  TT4                        2914 non-null   float64\n",
      " 20  T4U_measured               3163 non-null   object \n",
      " 21  T4U                        2915 non-null   float64\n",
      " 22  FTI_measured               3163 non-null   object \n",
      " 23  FTI                        2916 non-null   float64\n",
      " 24  TBG_measured               3163 non-null   object \n",
      " 25  TBG                        260 non-null    float64\n",
      "dtypes: float64(7), int64(1), object(18)\n",
      "memory usage: 642.6+ KB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Comparing different pipelines\n",
    "\n",
    "Using pipelines allow us to compare different pre-processing methods in a easy and efficient way. Here we will build different pipelines, each with different transformations, and then compare the results obtained for each one. But before we can do this, let's build a function that calls the pipeline's fit and predict_proba methods, followed by the computation of a few metrics, such as ROC AUC, F1, precision, recall, accuracy, and the confusion matrix. To compute these metrics, we use the **evaluate_set** function from the **dataprocessing.model_utils** module."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "def fit_and_get_results_bin(\n",
    "    pipeline: Pipeline,\n",
    "    x_train: pd.DataFrame,\n",
    "    y_train: pd.DataFrame,\n",
    "    x_test: pd.DataFrame,\n",
    "    y_test: pd.DataFrame,\n",
    "    best_th_auc: bool=True\n",
    "):\n",
    "    pipeline.fit(x_train, y_train)\n",
    "    pred_test = pipeline.predict_proba(x_test)[:, 1]\n",
    "    dp.evaluate_set(pipeline, y_test, pred_test, is_train=False, plot_pr=False, best_th_auc=best_th_auc)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We'll also test the efficiency of using scalers over the numerical features of the dataset. It only makes sense to scale the numerical features that doesn't represent one-hot encodings, so let's get the list of all float columns from the dataset. This list will represent the list of columns to which we'll apply the scaler transformations."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['age', 'TSH', 'T3', 'TT4', 'T4U', 'FTI', 'TBG']"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "float_cols = [col for col in df.columns if 'float' in df[col].dtype.name]\n",
    "float_cols"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Each pipeline can have different transformations. However, some of these transformations could be repeated among different pipelines. For example, all pipelines should have an imputer transformer. In the following cell we'll instantiate a few transformers in an effort to simplify the pipeline creation process."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "ohe_encoder = dp.EncoderOHE(drop=False, unknown_err=False, verbose=False)\n",
    "imputer = dp.BasicImputer(numerical={'missing_values':np.nan,\n",
    "\t\t\t\t\t\t\t\t\t'strategy':'constant',\n",
    "\t\t\t\t\t\t\t\t\t'fill_value':-1},\n",
    "                          verbose=False)\n",
    "feat_sel = dp.CatBoostSelection(catboost_log=False, verbose=False)\n",
    "cor_feat = dp.CorrelatedFeatures(save_json=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we just have to split the original dataset into train and test sets. After that, we can start comparing the different pipelines."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "train_x, test_x, train_y, test_y = dp.split_data(df, label_col, test_size=0.2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Pipeline 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[503  71]\n",
      " [  9  50]]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/mmendonca/ResponsibleAI/code/git/responsible-ai-mitigations/raimitigations/dataprocessing/model_utils.py:74: RuntimeWarning: invalid value encountered in true_divide\n",
      "  fscore = (2 * precision * recall) / (precision + recall)\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 87.36%\n",
      "\n",
      "Precision:  0.6978225077479339\n",
      "\n",
      "Recall:  0.8618821236638516\n",
      "\n",
      "F1 =  0.7409453652547575\n",
      "\n",
      "ROC AUC =  0.9112088820646076\n"
     ]
    }
   ],
   "source": [
    "pipe0 = Pipeline([\n",
    "            (\"encoder\", ohe_encoder),\n",
    "            (\"imputer\", imputer),\n",
    "            (\"estimator\", SVC(probability=True)),\n",
    "        ])\n",
    "fit_and_get_results_bin(pipe0, train_x, train_y, test_x, test_y, best_th_auc=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Pipeline 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[548  26]\n",
      " [  6  53]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 94.94%\n",
      "\n",
      "Precision:  0.8300278755198098\n",
      "\n",
      "Recall:  0.926504458749188\n",
      "\n",
      "F1 =  0.8698735738513722\n",
      "\n",
      "ROC AUC =  0.9268587964330006\n"
     ]
    }
   ],
   "source": [
    "pipe1 = Pipeline([\n",
    "            (\"encoder\", ohe_encoder),\n",
    "            (\"imputer\", imputer),\n",
    "            (\"scaler\", dp.DataStandardScaler(include_cols=float_cols, verbose=False)),\n",
    "            (\"estimator\", SVC(probability=True)),\n",
    "        ])\n",
    "fit_and_get_results_bin(pipe1, train_x, train_y, test_x, test_y, best_th_auc=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Pipeline 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[551  23]\n",
      " [  5  54]]\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAATUAAAEWCAYAAAAHJwCcAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMAAAsTAAALEwEAmpwYAAAeyUlEQVR4nO3deZxVdf3H8dd7ZpR9dUCQRXGXXJBwJdfUQM0lywUr7VeZuf60svxlaKQt+msxc8nUnymmaW4YIJZm7sUiLqCYYchmLCKiIDLD5/fHPYN3Jpi5F+bOPXPm/exxH957zvd+z+eCvf2e7XsUEZiZZUVFuQswM2tODjUzyxSHmpllikPNzDLFoWZmmeJQM7NMcahljKQOkh6StFzSPZvQz6mSHmnO2spB0kRJp5W7Dms5DrUykTRK0hRJ70lamPyf7xPN0PVngS2BLSLicxvbSUTcERFHNEM99Ug6WFJIur/B8j2S5Y8X2M9lksY21S4iRkbEbzeyXGuFHGplIOlC4BfAD8kF0EDgOuDYZuh+a+C1iKhphr5KZTGwn6Qt8padBrzWXBtQjv/9bosiwq8WfAHdgPeAzzXSph250FuQvH4BtEvWHQzMA74BLAIWAl9K1n0f+BBYk2zjy8BlwNi8vrcBAqhKPp8OzAZWAG8Ap+Ytfyrve/sDk4HlyT/3z1v3OPAD4Omkn0eA6g38trr6bwDOTpZVAvOB0cDjeW2vBuYC7wJTgQOS5SMa/M4X8uq4IqljFbB9suwryfrrgXvz+v8J8Cigcv974Vfzvfxfspa3H9AeuL+RNt8F9gWGAHsAewOX5K3vQy4c+5ELrmsl9YiIS8mN/n4fEZ0j4ubGCpHUCfglMDIiupALrunradcTGJ+03QL4GTC+wUhrFPAloDewOfDNxrYN3AZ8MXn/KeBlcgGebzK5P4OewO+AeyS1j4iHG/zOPfK+8wXgDKALMKdBf98AdpN0uqQDyP3ZnRZJwlk2ONRa3hbAkmh89/BUYExELIqIxeRGYF/IW78mWb8mIiaQG63stJH1rAV2ldQhIhZGxIz1tDkK+EdE3B4RNRFxJ/Aq8Om8Nv8XEa9FxCrgbnJhtEER8QzQU9JO5MLttvW0GRsRS5Nt/pTcCLap33lrRMxIvrOmQX8ryf05/gwYC5wbEfOa6M9aGYday1sKVEuqaqTNVtQfZcxJlq3ro0EorgQ6F1tIRLwPnAScCSyUNF7SzgXUU1dTv7zPb21EPbcD5wCHsJ6Rq6RvSnolOZP7DrnRaXUTfc5tbGVE/I3c7rbIha9ljEOt5T0LrAaOa6TNAnIH/OsM5D93zQr1PtAx73Of/JURMSkiDgf6kht9/aaAeupqmr+RNdW5HTgLmJCMotZJdg8vAk4EekREd3LH81RX+gb6bHRXUtLZ5EZ8C5L+LWMcai0sIpaTOyB+raTjJHWUtJmkkZKuTJrdCVwiqZek6qR9k5cvbMB04EBJAyV1Ay6uWyFpS0nHJsfWVpPbjV27nj4mADsml6FUSToJGAz8cSNrAiAi3gAOIncMsaEuQA25M6VVkkYDXfPW/xvYppgznJJ2BC4HPk9uN/QiSUM2rnpLK4daGSTHhy4kd/B/MbldpnOAB5ImlwNTgBeBl4BpybKN2dafgN8nfU2lfhBVJHUsAN4mFzBfX08fS4GjyR1oX0puhHN0RCzZmJoa9P1URKxvFDoJeJjcZR5zgA+ov2tZd2HxUknTmtpOsrs/FvhJRLwQEf8A/ge4XVK7TfkNli7yiR8zyxKP1MwsUxxqZpYpDjUzyxSHmpllSmMXgLY4VXUIbd6l3GVYEfbcZWC5S7AizJnzL5YsWaKmW25YZdetI2pWFdQ2Vi2eFBEjNmV7xUpXqG3ehXY7nVjuMqwIT//tV+UuwYowfJ9hm9xH1HxAu51PLqjtB89f09QdIM0uVaFmZq2AAG3SYK+kHGpmVrwUT1XnUDOz4nmkZmbZIaioLHcRG+RQM7PiCO9+mlmWyLufZpYxHqmZWaZ4pGZm2SGP1MwsQ4TPfppZlnikZmZZU+FjamaWFb5Ozcwyx2c/zSw7fJuUmWWNdz/NLDPk26TMLGs8UjOzTPFIzcyywxffmlmW+DYpM8sWj9TMLGt8TM3MMsUjNTPLFI/UzCwz5GNqZpYxqnComVlGCJB3P80sM5S8UsqhZmZFkkdqZpYtDjUzy5QKnygws8xI+TG19MatmaWSkmNqhbya7EsaIWmWpNclfWc96wdK+ouk5yW9KOnIpvp0qJlZ0Zoj1CRVAtcCI4HBwCmSBjdodglwd0TsCZwMXNdUbQ41MytaM43U9gZej4jZEfEhcBdwbIM2AXRN3ncDFjTVqY+pmVnRijj7WS1pSt7nGyPixuR9P2Bu3rp5wD4Nvn8Z8Iikc4FOwGFNbdChZmbFEajwJ7QviYhhm7C1U4BbI+KnkvYDbpe0a0Ss3dAXHGpmVhQ138W384EBeZ/7J8vyfRkYARARz0pqD1QDizbUqY+pmVnRmumY2mRgB0mDJG1O7kTAuAZt3gQ+mWxzF6A9sLixTj1SM7PiNcNALSJqJJ0DTAIqgVsiYoakMcCUiBgHfAP4jaQLyJ00OD0iorF+HWpmVhw1321SETEBmNBg2ei89zOB4cX06VAzs6L53k8zywwh3/tpZhmT3oGaQ83MitSMx9RKwaFmZkVzqJlZpjjUzCxTirhNqsWl9xRGK/DJ/Xbh73/4HlPvu5T/Pu3w/1g/oE8PHrjuXJ763cU8dMP5bNW7+7p1/bfswb3XnM1zd1/Cs7//LgP69mzBytuuPz8zk71OGMPQ4y/j57c+8h/rV3+4hv+6+BaGHn8Zh51+FW8uWFpv/dy33qb/gRdyze1/bqmSU6fQuwnKNZoraag1NQFca1ZRIa666EQ+d/517Hvi5ZxwxMfZaVCfem3GnH88d43/O58Y9SOuvGkio88+Zt2667//Ra65/VH2PfFyDjv9Kpa8vaKlf0KbU1u7lm9deTf3XH0Wz919Cfc+MpVXZy+s1+b2B5+lW9cOTLv/Mr4+6hAuu+bBeusv+fl9HLb/x1qy7FRqk6FW4ARwrdbHP7YNs+cuYc78paypqeW+P03jyIN2r9dmp2378uSUWQA8OeU1Rh64W275oD5UVVbw+N9fBeD9VR+yavWalv0BbdDUGf9i2wHVbNO/ms03q+Izhw9lwl9frNdm4hMvcspRudlvjj10T/46eRZ1d+WMf/wFBm61BTtv2+c/+m5r2mSoUdgEcK1W317dmP/vZes+L/j3Mvr26lavzYzX5nP0IUMAOPqQPejauQM9unViu4G9Wb5iFbdd+RX+OvbbjDnvOCpSfIwiKxYuXk6/LXus+7zVlj1YuHh5vTYLFn3Upqqqkq6dO/D28vd5b+Vqrr7tT3z7q03OJt02qMBXGZQy1NY3AVy/ho0knSFpiqQpUbOqhOW0vO9dfT/Dh27PX8d+m+FDt2f+v5dRW7uWqsoK9ttzO7539f0cetpVbN2vmlFH71vucq0RP7lxPF8/5VA6d2xX7lJSIc0jtbKf/UxmwbwRoKJj70bvvk+TQv6r/9aS5XzxopsA6NRhcz59yBDefW8VCxa9w0uvzWPO/NxB6AmPv8Cw3QYxdtyzLfcD2qBCRtdb9c616bdlD2pqann3vVX07NaJKTPm8OBj07n0mgdYvmIVFRWiXbvNOOPEg1r6Z5SdRKr3LEoZaoVMANdqTZs5h+0G9mLgVluwcNE7fObwoXz1e7fWa9OzWyeWvbuSiOCC0z/FHQ89t+673Tp3YIvunVn6znscsNdOTH/lzTL8irZl6OCt+eebi5kzfwl9e3fnvj9N4zc/OL1emxEH7Mad4//G3rtvy4OPPc+Be+2IJCb+5oJ1bX5843g6dWjXJgMtp+0+oX3dBHDkwuxkYFQJt9eiamvXctGVd3PvL8+mslLcMe45Xp39Fhd/7Simv/ImE594iU98fAdGn30MEfDM86/zrSvvBmDt2uB7Vz/Ag9ediySmv/omv73/6TL/ouyrqqrkyotO5ITzrqW2Njj1mH3ZZbu+/PCGPzJkl4EcedDufOHY/Tnz0tsYevxl9OjaiZuv+FK5y06lFGcaamK+tU3rPPeMvl/w0QRwVzTWvqJj72i304klq8ea37LJvyp3CVaE4fsMY+rUKZsUSe377Bhbn3ZNQW1fu3LE1E18RkHRSnpMbX0TwJlZK6d0j9TKfqLAzFoX0XZPFJhZRjnUzCw7vPtpZlkiPPWQmWVK271OzcwyKsWZ5lAzsyK14dukzCyDfEzNzDInxZnmUDOz4nmkZmaZkuJMc6iZWZH8MGMzyxIhn/00s2xJ8UDNoWZmxfPup5llh29oN7Ms8cW3ZpY5DjUzyxSf/TSz7PAxNTPLEqV8PrWKchdgZq2PVNir6X40QtIsSa9L+s4G2pwoaaakGZJ+11SfHqmZWdEqmmGkJqkSuBY4HJgHTJY0LiJm5rXZAbgYGB4RyyT1bqpfh5qZFUXNN0nk3sDrETE716/uAo4FZua1+SpwbUQsA4iIRU116t1PMytahQp7AdWSpuS9zsjrph8wN+/zvGRZvh2BHSU9Lek5SSOaqs0jNTMrWhEnCpZExLBN2FQVsANwMNAfeELSbhHxTmNfWC9J1wCxofURcd5Gl2lmrVoznfycDwzI+9w/WZZvHvC3iFgDvCHpNXIhN3lDnTY2UpuykYWaWYaJ3GUdzWAysIOkQeTC7GRgVIM2DwCnAP8nqZrc7ujsxjrdYKhFxG/zP0vqGBEri6/bzLKmOc4TRESNpHOASUAlcEtEzJA0BpgSEeOSdUdImgnUAt+KiKWN9dvkMTVJ+wE3A52BgZL2AL4WEWdt2k8ys1ZJzTdJZERMACY0WDY6730AFyavghRy9vMXwKeApclGXgAOLHQDZpYtInedWiGvcijo7GdEzG1wtqO2NOWYWWuQ4rukCgq1uZL2B0LSZsD5wCulLcvM0qy13/t5JnA2uYviFgBDks9m1gYVet9nuXKvyZFaRCwBTm2BWsyslahszSM1SdtKekjSYkmLJD0oaduWKM7M0klSQa9yKGT383fA3UBfYCvgHuDOUhZlZumVO/tZ8L2fLa6QUOsYEbdHRE3yGgu0L3VhZpZSBY7SyjVSa+zez57J24nJ5G13kbsX9CQaXCxnZm1Lig+pNXqiYCq5EKsr/2t564LcxG1m1gal+ZKOxu79HNSShZhZ6yCgsrU/TUrSrsBg8o6lRcRtpSrKzNItvZFW2A3tl5KboG0wuWNpI4GnAIeaWRskNc8zCkqlkLOfnwU+CbwVEV8C9gC6lbQqM0u1Vn1HAbAqItZKqpHUFVhE/dkqzayNaZUnCvJMkdQd+A25M6LvAc+WsigzS7cUZ1pB937WTQZ5g6SHga4R8WJpyzKztJLUOs9+Shra2LqImFaaksws7Vrr7udPG1kXwKHNXAu77zyAx578RXN3ayXU45DRTTey1Fj92oJm6SfNDwxu7OLbQ1qyEDNrHUTrHamZma1Xig+pOdTMrDhSBm6TMjPLl+JMK2jmW0n6vKTRyeeBkvYufWlmllZpvqOgkJMY1wH7kXv0O8AK4NqSVWRmqZaF537uExFDJT0PEBHLJG1e4rrMLMVa5SUdedZIqiR3bRqSegFrS1qVmaVaiq/oKCjUfgncD/SWdAW5WTsuKWlVZpZarfY2qToRcYekqeSmHxJwXET4Ce1mbViKM62gSSIHAiuBh/KXRcSbpSzMzNKp7kRBWhWy+zmejx7A0h4YBMwCPlbCuswsxVKcaQXtfu6W/zmZveOsDTQ3s6wr44OKC1H0HQURMU3SPqUoxsxaB6X40SuFHFO7MO9jBTAUaJ75S8ys1RFQleIL1QoZqXXJe19D7hjbvaUpx8xag1Y79VBy0W2XiPhmC9VjZimXO/tZ7io2rLHpvKsiokbS8JYsyMxSrow3qxeisZHa38kdP5suaRxwD/B+3cqIuK/EtZlZSrX269TaA0vJPZOg7nq1ABxqZm2QgMoUnyhorLTeyZnPl4GXkn/OSP75cgvUZmapJCoKfDXZkzRC0ixJr0v6TiPtTpAUkoY11WdjI7VKoDOst7Joslozy6Tcg1eaoZ/cichrgcOBecBkSeMiYmaDdl2A84G/FdJvY6G2MCLGbGS9ZpZVzXdHwd7A6xExG0DSXcCxwMwG7X4A/AT4ViGdNrb7md4jgWZWVkXMfFstaUre64y8bvoBc/M+z0uWrZPcljkgIsYXWltjI7VPFtqJmbUdRe5+LomIJo+DrXc7UgXwM+D0Yr7X2MOM396YQsws+5ppksj5wIC8z/2TZXW6ALsCjyd3MPQBxkk6JiKmbKhTPyLPzIoimu0ZBZOBHSQNIhdmJwOj6lZGxHKget12pceBbzYWaDRfbWbWZih372chr8ZERA1wDjAJeAW4OyJmSBoj6ZiNLc8jNTMrWnOdRYyICcCEBstGb6DtwYX06VAzs6JkYTpvM7N60htpDjUzK5qoSPHcQw41MytKM579LAmHmpkVrdXOfGtmtj7pjTSHmpkVSx6pmVmGCKh0qJlZlqQ30hxqZrYRUjxQc6iZWXFyl3SkN9UcamZWNI/UzCxDhDxSM7Os8NlPM8uWVvyEdjOz9XKomVmm+JiamWVGbpLIclexYQ41MyuaZ741s0zx7meG/OW5Vxh99X2sXRuccvS+nPOFw+qtX/1hDedfPpaXZs2jR9eOXD/mNAb03YI1NbV888d38fJr86ipreWzI/bi3C8cDsA+n/0+nTu2p6JCVFVWMvHmb5Tjp7UJn9xre350zpFUVorbx0/jF3c+WW/9gC27cc1Fx1PdrSPLVqzia1fcy4Il77Lrdn346QWfpkundqytXctP73iC+//ycpl+RXm12d1PSbcARwOLImLXUm2nJdXWruW7P/sDd/786/Tt3Z0jv/IzjvjEruw4qM+6Nnf+8Tm6denI07+/hAf/PI0rrn+IG8aczh8fm86Ha2p49LZvs+qDDzn48z/iuMOGMqDvFgDc88uz6dm9c7l+WptQUSGuOv9ojv/Wb1mw+F0eu+FrTHzmVWbNWbyuzZgzP8Vdj0znrknTOWDPQYz+6mGc+aP7WLV6DV//0b3Mnv82fbbowl9+fSaP/v113n3/gzL+onJJ98W3pZyV91ZgRAn7b3HPvzKHbfpXs3W/ajbfrIpjD9uTSU+9VK/NI0+9xOdG7gXAUQfvwVNT/0FEIMHKVR9SU1PLqtVr2Kyqis6d2pfjZ7RZH9+5P7MXvM2chctYU1PLfY+9xJHDd67XZqdtevPktNkAPPn8G4xM1v9z3lJmz38bgLeWrmDJO+9T3b1jy/6AtEiuUyvkVQ4lC7WIeAJ4u1T9l8Nbi5ezVe8e6z737dWdtxYv32CbqqpKunZqz7Ll73PUIUPo2GFz9jxuNHuf8H3OPOUQenTtBOQm3DvlwhsY8V//y9gHn2m5H9TG9K3uwvxFH/19LVj8Ln2ru9ZrM+Ofb3H0gYMBOPqAXejaqT09unao12bozv3YrKqSNxYsK33RKaUCX+VQ9mNqks4AzgDoP2Bgmaspnekz51BZUcG0B8awfMVKjj/rlxwwbEe27lfN/dedR99e3VmybAUn//f1bL/1luw7ZLtyl9wmfe/6SVx53lGM+tSePPPiv5i/eDm1tbFu/ZY9O3PDxSdw1o/vIyIa6Sm70n6bVNkfChMRN0bEsIgYtkV1dbnLaVSfXt1YsOij/zovXPwOfXp122Cbmppa3n3/A3p068T9f5rGwfvszGZVlVT36MJeuw3ihVfnArkRH0B1jy6MPHA3ps+c0zI/qI1ZuGQF/Xp/9Pe1Va+uLFzybr02by1dwRcvvYuDzriey296FGDdcbMuHdvx+x99nstv/jNTXpnXcoWnUYqHamUPtdZkyM4DeWPuEt5csJQP19Tw4J+f54jh9c+BHDF8V+6ZOBmA8Y+/wPChOyCJflt25+lp/wBg5arVTJs5h+233pKVq1bz3soP1i3/6+RZ7LRt35b9YW3EtFfns12/ngzs053Nqir5zKG7MfGZV+u16dm147r59y849QDumPg8AJtVVXL7D07hrkdeYNwTM1u89rRRgf8rh7LvfrYmVVWVXH7hCYy68AbWrl3LSUftw07b9uWqmyawx84DOeITu3Ly0fty3g/GMvyky+netSPXXfZFAE7/zAFc8MPfccjnf0wQnHTkPgzefivmzF/Cl//nFiB3dvW4w4dyyL67lPNnZlbt2rVc9Mvx3HvlF6msqOCOidN49V+LufhLhzJ91nwmPjOLTwzZhtFfPZyI4JkX5/Ctq/8IwPEHf4z9d9+anl07MGrEEADO+vH9vPzPt8r4i8onxXufqFTHBSTdCRwMVAP/Bi6NiJsb+86QoR+Px578W0nqsdLoN2JMuUuwIqyefhNrVyzYpEjaZbc947YHHy+o7d7bdZ8aEcM2ZXvFKtlILSJOKVXfZlZmKR6peffTzIoi+d5PM8uY9EaaQ83MNkaKU82hZmZFSve9nw41Mytaig+pOdTMrDjCoWZmGePdTzPLlDSP1Hzvp5kVrbnuZ5c0QtIsSa9L+s561l8oaaakFyU9Kmnrpvp0qJlZcQpNtCZSTVIlcC0wEhgMnCJpcINmzwPDImJ34A/AlU2V51Azs6I10ywdewOvR8TsiPgQuAs4Nr9BRPwlIlYmH58D+jfVqY+pmVlRinzwSrWkKXmfb4yIG5P3/YC5eevmAfs00teXgYlNbdChZmbFKzzUljTHLB2SPg8MAw5qqq1DzcyK1kyXdMwHBuR97p8sq78t6TDgu8BBEbG6qU59TM3MitZMT5OaDOwgaZCkzYGTgXH1t6M9gV8Dx0TEokJqc6iZWdGa45KOiKgBzgEmAa8Ad0fEDEljJB2TNLsK6AzcI2m6pHEb6G4d736aWfGa6eLbiJgATGiwbHTe+8OK7dOhZmZF8SSRZpY56Y00h5qZbYwUp5pDzcyK5EkizSxjUnxIzaFmZsXxJJFmljne/TSzTPFIzcwyJcWZ5lAzsyIVdl9n2TjUzGwjpDfVHGpmVpQiJ4lscQ41Myuadz/NLFN8SYeZZUt6M82hZmbFS3GmOdTMrDgFTtVdNg41MyuaUpxqDjUzK1p6I82hZmYbIcUDNYeamRXLk0SaWYZ4PjUzyxyHmpllinc/zSw7fJ2amWWJ8CUdZpY1KU41h5qZFc3H1MwsUzxJpJlli0PNzLLEu59mlhlpv6NAEVHuGtaRtBiYU+46SqAaWFLuIqwoWf072zoiem1KB5IeJvfnU4glETFiU7ZXrFSFWlZJmhIRw8pdhxXOf2etV0W5CzAza04ONTPLFIday7ix3AVY0fx31kr5mJqZZYpHamaWKQ41M8sUh1oJSRohaZak1yV9p9z1WNMk3SJpkaSXy12LbRyHWolIqgSuBUYCg4FTJA0ub1VWgFuBFr1Y1JqXQ6109gZej4jZEfEhcBdwbJlrsiZExBPA2+WuwzaeQ610+gFz8z7PS5aZWQk51MwsUxxqpTMfGJD3uX+yzMxKyKFWOpOBHSQNkrQ5cDIwrsw1mWWeQ61EIqIGOAeYBLwC3B0RM8pblTVF0p3As8BOkuZJ+nK5a7Li+DYpM8sUj9TMLFMcamaWKQ41M8sUh5qZZYpDzcwyxaHWikiqlTRd0suS7pHUcRP6ulXSZ5P3NzV2s72kgyXtvxHb+Jek/3jq0IaWN2jzXpHbukzSN4ut0bLHoda6rIqIIRGxK/AhcGb+Skkb9RzXiPhKRMxspMnBQNGhZlYODrXW60lg+2QU9aSkccBMSZWSrpI0WdKLkr4GoJxfJfO7/RnoXdeRpMclDUvej5A0TdILkh6VtA258LwgGSUeIKmXpHuTbUyWNDz57haSHpE0Q9JN0PRjvCU9IGlq8p0zGqz7ebL8UUm9kmXbSXo4+c6TknZulj9Nyww/ob0VSkZkI4GHk0VDgV0j4o0kGJZHxF6S2gFPS3oE2BPYidzcblsCM4FbGvTbC/gNcGDSV8+IeFvSDcB7EfG/SbvfAT+PiKckDSR318QuwKXAUxExRtJRQCFX4/9Xso0OwGRJ90bEUqATMCUiLpA0Oun7HHIPRDkzIv4haR/gOuDQjfhjtIxyqLUuHSRNT94/CdxMbrfw7xHxRrL8CGD3uuNlQDdgB+BA4M6IqAUWSHpsPf3vCzxR11dEbGhescOAwdK6gVhXSZ2TbXwm+e54ScsK+E3nSTo+eT8gqXUpsBb4fbJ8LHBfso39gXvytt2ugG1YG+JQa11WRcSQ/AXJ/7nfz18EnBsRkxq0O7IZ66gA9o2ID9ZTS8EkHUwuIPeLiJWSHgfab6B5JNt9p+GfgVk+H1PLnknA1yVtBiBpR0mdgCeAk5Jjbn2BQ9bz3eeAAyUNSr7bM1m+AuiS1+4R4Ny6D5KGJG+fAEYly0YCPZqotRuwLAm0ncmNFOtUAHWjzVHkdmvfBd6Q9LlkG5K0RxPbsDbGoZY9N5E7XjYteXjIr8mNyO8H/pGsu43cTBT1RMRi4Axyu3ov8NHu30PA8XUnCoDzgGHJiYiZfHQW9vvkQnEGud3QN5uo9WGgStIrwI/JhWqd94G9k99wKDAmWX4q8OWkvhl4inRrwLN0mFmmeKRmZpniUDOzTHGomVmmONTMLFMcamaWKQ41M8sUh5qZZcr/AyIaDrF+HGZwAAAAAElFTkSuQmCC",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 95.58%\n",
      "\n",
      "Precision:  0.8461529477716527\n",
      "\n",
      "Recall:  0.9375922754384929\n",
      "\n",
      "F1 =  0.8846694429984383\n",
      "\n",
      "ROC AUC =  0.9362782731943543\n"
     ]
    }
   ],
   "source": [
    "pipe2 = Pipeline([\n",
    "            (\"encoder\", ohe_encoder),\n",
    "            (\"imputer\", imputer),\n",
    "            (\"scaler\", dp.DataStandardScaler(include_cols=float_cols)),\n",
    "            (\"feat_sel\", feat_sel),\n",
    "            (\"estimator\", SVC(probability=True)),\n",
    "        ])\n",
    "fit_and_get_results_bin(pipe2, train_x, train_y, test_x, test_y, best_th_auc=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Using SKLearn and Dataprocessing transformers in the same Pipeline\n",
    "\n",
    "The transformations in SKLearn always return a numpy array, while the transformers in our **dataprocessing** library usually operate over a Pandas DataFrame (although these transformers also accepts numpy arrays as input). The latter uses dataframes in order to allow it to filter specific columns, just like we did when we created the DataStandardScaler object and specified that only the columns in the **float_cols** list should be scaled. With a numpy array, we can also do this, but instead of using column names, we are forced to use the column indices instead, since numpy arrays doesn't have column names.\n",
    "\n",
    "In this scenario, when we place a transformer from the SKLearn library before a transformer from the **dataprocessing** library in a Pipeline, we must be aware that we'll lose the column names (considering that the input to the Pipeline is indeed a Pandas dataframe) after the sklearn transformer calls its transform() method. This way, all of the transformers after this point will have to use column indices instead of column names, as depicted in the following example. In this example, we'll use the SKLearn's **SimpleImputer** instead of using our similar class, the **BasicImputer**, just so we can test the behavior of the Pipeline class with transformers from both SKLearn and **dataprocessing** libraries. We'll execute the following steps in this pipeline: \n",
    "1) encode the columns \"sex\" and \"on_thyroxine\" using one-hot encoding,\n",
    "2) impute missing data by replacing it with a -100 value,\n",
    "3) apply a min-max scaler over the column \"age\",\n",
    "4) apply an ordinal encoding over all of the remaining categorical variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>...</th>\n",
       "      <th>16</th>\n",
       "      <th>17</th>\n",
       "      <th>18</th>\n",
       "      <th>19</th>\n",
       "      <th>20</th>\n",
       "      <th>21</th>\n",
       "      <th>22</th>\n",
       "      <th>23</th>\n",
       "      <th>24</th>\n",
       "      <th>25</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.757576</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.75</td>\n",
       "      <td>1</td>\n",
       "      <td>162.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.883838</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.03</td>\n",
       "      <td>1</td>\n",
       "      <td>119.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.797980</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>67.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.82</td>\n",
       "      <td>1</td>\n",
       "      <td>82.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>111.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.87</td>\n",
       "      <td>1</td>\n",
       "      <td>127.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.606061</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>149.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.99</td>\n",
       "      <td>1</td>\n",
       "      <td>150.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>628</th>\n",
       "      <td>0.691919</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>95.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.97</td>\n",
       "      <td>1</td>\n",
       "      <td>99.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>629</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>127.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.1</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>630</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>144.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.24</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>631</th>\n",
       "      <td>0.772727</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>104.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.93</td>\n",
       "      <td>1</td>\n",
       "      <td>112.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>632</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>107.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.85</td>\n",
       "      <td>1</td>\n",
       "      <td>126.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>633 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            0  1  2  3  4  5  6  7  8  9  ...     16  17    18  19     20  21  \\\n",
       "0    0.757576  1  0  0  0  0  0  0  0  0  ...  122.0   1  0.75   1  162.0   0   \n",
       "1    0.883838  0  0  0  0  0  0  0  0  0  ...  122.0   1  1.03   1  119.0   0   \n",
       "2    0.797980  0  0  0  0  0  0  0  0  0  ...   67.0   1  0.82   1   82.0   0   \n",
       "3    0.904040  0  0  1  1  0  0  0  0  0  ...  111.0   1  0.87   1  127.0   0   \n",
       "4    0.606061  0  0  0  0  0  0  0  0  0  ...  149.0   1  0.99   1  150.0   0   \n",
       "..        ... .. .. .. .. .. .. .. .. ..  ...    ...  ..   ...  ..    ...  ..   \n",
       "628  0.691919  0  0  0  0  0  0  0  0  0  ...   95.0   1  0.97   1   99.0   0   \n",
       "629  0.782828  0  0  0  0  0  0  0  0  0  ...  127.0   1   1.1   1  116.0   0   \n",
       "630  0.782828  0  0  0  0  0  0  0  0  0  ...  144.0   1  1.24   1  116.0   0   \n",
       "631  0.772727  0  0  0  0  0  0  0  0  0  ...  104.0   1  0.93   1  112.0   0   \n",
       "632  0.904040  0  0  0  0  0  0  0  0  0  ...  107.0   1  0.85   1  126.0   0   \n",
       "\n",
       "       22  23 24  25  \n",
       "0    -100   0  0   0  \n",
       "1    -100   0  0   0  \n",
       "2    -100   0  0   1  \n",
       "3    -100   0  0   0  \n",
       "4    -100   1  0   1  \n",
       "..    ...  .. ..  ..  \n",
       "628  -100   0  0   0  \n",
       "629  -100   1  0   1  \n",
       "630  -100   0  0   0  \n",
       "631  -100   1  0   0  \n",
       "632  -100   0  0   0  \n",
       "\n",
       "[633 rows x 26 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pipe = Pipeline([\n",
    "            (\"encoder_ohe\", dp.EncoderOHE(col_encode=[\"sex\", \"on_thyroxine\"])), # dataprocessing\n",
    "            (\"imputer\", SimpleImputer(strategy=\"constant\", fill_value=-100)),   # sklearn\n",
    "            (\"scaler\", dp.DataMinMaxScaler(include_cols=[0])),                  # dataprocessing\n",
    "            (\"ordinal_encoder\", dp.EncoderOrdinal(verbose=False)),              # dataprocessing\n",
    "        ])\n",
    "pipe.fit(train_x, train_y)\n",
    "new_x_test = pipe.transform(test_x)\n",
    "new_x_test"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "As we can see in the previous cell, we used column names when instantiating the EncoderOHE class, but used column indices when specifying the columns that should be scaled using the DataMinMaxScaler. This is required because the SimpleImputer object returns a numpy array, which has no column names. From there onward, the column names are lost. We could use indices for all transformers. This would result in the same new x test set, as showed in the following cell:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>...</th>\n",
       "      <th>16</th>\n",
       "      <th>17</th>\n",
       "      <th>18</th>\n",
       "      <th>19</th>\n",
       "      <th>20</th>\n",
       "      <th>21</th>\n",
       "      <th>22</th>\n",
       "      <th>23</th>\n",
       "      <th>24</th>\n",
       "      <th>25</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.757576</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.75</td>\n",
       "      <td>1</td>\n",
       "      <td>162.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.883838</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.03</td>\n",
       "      <td>1</td>\n",
       "      <td>119.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.797980</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>67.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.82</td>\n",
       "      <td>1</td>\n",
       "      <td>82.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>111.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.87</td>\n",
       "      <td>1</td>\n",
       "      <td>127.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.606061</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>149.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.99</td>\n",
       "      <td>1</td>\n",
       "      <td>150.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>628</th>\n",
       "      <td>0.691919</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>95.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.97</td>\n",
       "      <td>1</td>\n",
       "      <td>99.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>629</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>127.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.1</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>630</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>144.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.24</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>631</th>\n",
       "      <td>0.772727</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>104.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.93</td>\n",
       "      <td>1</td>\n",
       "      <td>112.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>632</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>107.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.85</td>\n",
       "      <td>1</td>\n",
       "      <td>126.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>633 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            0  1  2  3  4  5  6  7  8  9  ...     16  17    18  19     20  21  \\\n",
       "0    0.757576  1  0  0  0  0  0  0  0  0  ...  122.0   1  0.75   1  162.0   0   \n",
       "1    0.883838  0  0  0  0  0  0  0  0  0  ...  122.0   1  1.03   1  119.0   0   \n",
       "2    0.797980  0  0  0  0  0  0  0  0  0  ...   67.0   1  0.82   1   82.0   0   \n",
       "3    0.904040  0  0  1  1  0  0  0  0  0  ...  111.0   1  0.87   1  127.0   0   \n",
       "4    0.606061  0  0  0  0  0  0  0  0  0  ...  149.0   1  0.99   1  150.0   0   \n",
       "..        ... .. .. .. .. .. .. .. .. ..  ...    ...  ..   ...  ..    ...  ..   \n",
       "628  0.691919  0  0  0  0  0  0  0  0  0  ...   95.0   1  0.97   1   99.0   0   \n",
       "629  0.782828  0  0  0  0  0  0  0  0  0  ...  127.0   1   1.1   1  116.0   0   \n",
       "630  0.782828  0  0  0  0  0  0  0  0  0  ...  144.0   1  1.24   1  116.0   0   \n",
       "631  0.772727  0  0  0  0  0  0  0  0  0  ...  104.0   1  0.93   1  112.0   0   \n",
       "632  0.904040  0  0  0  0  0  0  0  0  0  ...  107.0   1  0.85   1  126.0   0   \n",
       "\n",
       "       22  23 24  25  \n",
       "0    -100   0  0   0  \n",
       "1    -100   0  0   0  \n",
       "2    -100   0  0   1  \n",
       "3    -100   0  0   0  \n",
       "4    -100   1  0   1  \n",
       "..    ...  .. ..  ..  \n",
       "628  -100   0  0   0  \n",
       "629  -100   1  0   1  \n",
       "630  -100   0  0   0  \n",
       "631  -100   1  0   0  \n",
       "632  -100   0  0   0  \n",
       "\n",
       "[633 rows x 26 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pipe = Pipeline([\n",
    "            (\"encoder_ohe\", dp.EncoderOHE(col_encode=[1, 2])),                  # dataprocessing\n",
    "            (\"imputer\", SimpleImputer(strategy=\"constant\", fill_value=-100)),   # sklearn\n",
    "            (\"scaler\", dp.DataMinMaxScaler(include_cols=[0])),                  # dataprocessing\n",
    "            (\"ordinal_encoder\", dp.EncoderOrdinal(verbose=False)),              # dataprocessing\n",
    "        ])\n",
    "pipe.fit(train_x, train_y)\n",
    "new_x_test = pipe.transform(test_x)\n",
    "new_x_test"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using column indices is not as intuitive as using column names. Using indices is also more error prone, especially when dealing with a pipeline with transformations that could change the order of the columns, such as the EncoderOHE and feature selection methods. In these scenarios, the index of a column might change in the middle of the pipeline, making it harder for the user to know exactly the column index that they should use to apply a specific operation over a specific column. Therefore, it is interesting that the user continues to use only column names when possible. In the remainder of this section, we'll present three solutions to this problem.\n",
    "\n",
    "### Solution 1: use the Pipeline class with only transformers from the dataprocessing library\n",
    "\n",
    "The first solution is pretty straightforward: use only transformers from the **dataprocessing** library. Note that an estimator from SKLearn or other libraries could still be used in the end of the pipeline, but the transformers used must be always from the **dataprocessing** library. Since all transformers from this library operate over Pandas Dataframes, and if all transformers in the pipeline return dataframes, then at no point in the pipeline this dataframe will be lost. This guarantees that all transformers will receive a dataframe as input, without loosing the column names. As a result, all transformers are allowed to use filters based on column names.\n",
    "\n",
    "Let's recreate the previous pipeline using only transformers from our library. For this, we'll replace the **SimpleImputer** by the **BasicImputer**. This allows us to use column names when specifying which columns the **DataMinMaxScaler** should be applied on:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>query_on_thyroxine</th>\n",
       "      <th>on_antithyroid_medication</th>\n",
       "      <th>thyroid_surgery</th>\n",
       "      <th>query_hypothyroid</th>\n",
       "      <th>query_hyperthyroid</th>\n",
       "      <th>pregnant</th>\n",
       "      <th>sick</th>\n",
       "      <th>tumor</th>\n",
       "      <th>lithium</th>\n",
       "      <th>...</th>\n",
       "      <th>TT4</th>\n",
       "      <th>T4U_measured</th>\n",
       "      <th>T4U</th>\n",
       "      <th>FTI_measured</th>\n",
       "      <th>FTI</th>\n",
       "      <th>TBG_measured</th>\n",
       "      <th>TBG</th>\n",
       "      <th>sex_M</th>\n",
       "      <th>sex_nan</th>\n",
       "      <th>on_thyroxine_t</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>956</th>\n",
       "      <td>0.757576</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.75</td>\n",
       "      <td>1</td>\n",
       "      <td>162.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1009</th>\n",
       "      <td>0.883838</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.03</td>\n",
       "      <td>1</td>\n",
       "      <td>119.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2187</th>\n",
       "      <td>0.797980</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>67.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.82</td>\n",
       "      <td>1</td>\n",
       "      <td>82.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>961</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>111.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.87</td>\n",
       "      <td>1</td>\n",
       "      <td>127.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2514</th>\n",
       "      <td>0.606061</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>149.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.99</td>\n",
       "      <td>1</td>\n",
       "      <td>150.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2864</th>\n",
       "      <td>0.691919</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>95.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.97</td>\n",
       "      <td>1</td>\n",
       "      <td>99.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1034</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>127.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.10</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1909</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>144.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.24</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2398</th>\n",
       "      <td>0.772727</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>104.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.93</td>\n",
       "      <td>1</td>\n",
       "      <td>112.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>275</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>107.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.85</td>\n",
       "      <td>1</td>\n",
       "      <td>126.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>633 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           age  query_on_thyroxine  on_antithyroid_medication  \\\n",
       "956   0.757576                   1                          0   \n",
       "1009  0.883838                   0                          0   \n",
       "2187  0.797980                   0                          0   \n",
       "961   0.904040                   0                          0   \n",
       "2514  0.606061                   0                          0   \n",
       "...        ...                 ...                        ...   \n",
       "2864  0.691919                   0                          0   \n",
       "1034  0.782828                   0                          0   \n",
       "1909  0.782828                   0                          0   \n",
       "2398  0.772727                   0                          0   \n",
       "275   0.904040                   0                          0   \n",
       "\n",
       "      thyroid_surgery  query_hypothyroid  query_hyperthyroid  pregnant  sick  \\\n",
       "956                 0                  0                   0         0     0   \n",
       "1009                0                  0                   0         0     0   \n",
       "2187                0                  0                   0         0     0   \n",
       "961                 1                  1                   0         0     0   \n",
       "2514                0                  0                   0         0     0   \n",
       "...               ...                ...                 ...       ...   ...   \n",
       "2864                0                  0                   0         0     0   \n",
       "1034                0                  0                   0         0     0   \n",
       "1909                0                  0                   0         0     0   \n",
       "2398                0                  0                   0         0     0   \n",
       "275                 0                  0                   0         0     0   \n",
       "\n",
       "      tumor  lithium  ...    TT4  T4U_measured   T4U  FTI_measured    FTI  \\\n",
       "956       0        0  ...  122.0             1  0.75             1  162.0   \n",
       "1009      0        0  ...  122.0             1  1.03             1  119.0   \n",
       "2187      0        0  ...   67.0             1  0.82             1   82.0   \n",
       "961       0        0  ...  111.0             1  0.87             1  127.0   \n",
       "2514      0        0  ...  149.0             1  0.99             1  150.0   \n",
       "...     ...      ...  ...    ...           ...   ...           ...    ...   \n",
       "2864      0        0  ...   95.0             1  0.97             1   99.0   \n",
       "1034      0        0  ...  127.0             1  1.10             1  116.0   \n",
       "1909      0        0  ...  144.0             1  1.24             1  116.0   \n",
       "2398      0        0  ...  104.0             1  0.93             1  112.0   \n",
       "275       0        0  ...  107.0             1  0.85             1  126.0   \n",
       "\n",
       "      TBG_measured    TBG  sex_M  sex_nan  on_thyroxine_t  \n",
       "956              0 -100.0      0        0               0  \n",
       "1009             0 -100.0      0        0               0  \n",
       "2187             0 -100.0      0        0               1  \n",
       "961              0 -100.0      0        0               0  \n",
       "2514             0 -100.0      1        0               1  \n",
       "...            ...    ...    ...      ...             ...  \n",
       "2864             0 -100.0      0        0               0  \n",
       "1034             0 -100.0      1        0               1  \n",
       "1909             0 -100.0      0        0               0  \n",
       "2398             0 -100.0      1        0               0  \n",
       "275              0 -100.0      0        0               0  \n",
       "\n",
       "[633 rows x 26 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "miss_dict ={'missing_values':np.nan, 'strategy':'constant', 'fill_value':-100}\n",
    "\n",
    "pipe = Pipeline([\n",
    "            (\"encoder_ohe\", dp.EncoderOHE(col_encode=[\"sex\", \"on_thyroxine\"])),                         # dataprocessing\n",
    "            (\"imputer\", dp.BasicImputer(numerical=miss_dict, categorical=miss_dict, verbose=False)),    # dataprocessing\n",
    "            (\"scaler\", dp.DataMinMaxScaler(include_cols=[\"age\"])),                                      # dataprocessing\n",
    "            (\"ordinal_encoder\", dp.EncoderOrdinal(verbose=False)),                                      # dataprocessing\n",
    "        ])\n",
    "pipe.fit(train_x, train_y)\n",
    "new_x_test = pipe.transform(test_x)\n",
    "new_x_test"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Solution 2: use the SklearnTransformerWrapper class\n",
    "\n",
    "If there is a specific transformer from the **SKLearn** library not present in the **dataprocessing** library, then the user has no alternative but to use the **SKLearn** transformer. The **SklearnTransformerWrapper** class, from the **Feature Engine library**, is a wrapper for transformers from the **SKLearn** library that forces, among other features, forces the output of the transformers to be a pandas dataframe if the input is also a dataframe. This solves our problem, since this way the dataframe is never lost. To do this, the user must pass the transformer object to the **SklearnTransformerWrapper** constructor when instantiating it. The **SklearnTransformerWrapper** object will then allow users to use the fit and transform methods, but now, the transform method returns a pandas dataframe instead of a numpy array.\n",
    "\n",
    "The following cell shows how to use the SklearnTransformerWrapper to wrap a transformer from the SKLearn library and then use it in a Pipeline. Before running the following cell, make sure to install the **feature-engine** package [following this link.](https://pypi.org/project/feature-engine/#:~:text=Feature-engine%20is%20a%20Python%20library%20with%20multiple%20transformers,parameters%20from%20the%20data%20and%20then%20transform%20it.)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>query_on_thyroxine</th>\n",
       "      <th>on_antithyroid_medication</th>\n",
       "      <th>thyroid_surgery</th>\n",
       "      <th>query_hypothyroid</th>\n",
       "      <th>query_hyperthyroid</th>\n",
       "      <th>pregnant</th>\n",
       "      <th>sick</th>\n",
       "      <th>tumor</th>\n",
       "      <th>lithium</th>\n",
       "      <th>...</th>\n",
       "      <th>TT4</th>\n",
       "      <th>T4U_measured</th>\n",
       "      <th>T4U</th>\n",
       "      <th>FTI_measured</th>\n",
       "      <th>FTI</th>\n",
       "      <th>TBG_measured</th>\n",
       "      <th>TBG</th>\n",
       "      <th>sex_M</th>\n",
       "      <th>sex_nan</th>\n",
       "      <th>on_thyroxine_t</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>956</th>\n",
       "      <td>0.757576</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.75</td>\n",
       "      <td>1</td>\n",
       "      <td>162.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1009</th>\n",
       "      <td>0.883838</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.03</td>\n",
       "      <td>1</td>\n",
       "      <td>119.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2187</th>\n",
       "      <td>0.797980</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>67.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.82</td>\n",
       "      <td>1</td>\n",
       "      <td>82.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>961</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>111.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.87</td>\n",
       "      <td>1</td>\n",
       "      <td>127.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2514</th>\n",
       "      <td>0.606061</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>149.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.99</td>\n",
       "      <td>1</td>\n",
       "      <td>150.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2864</th>\n",
       "      <td>0.691919</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>95.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.97</td>\n",
       "      <td>1</td>\n",
       "      <td>99.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1034</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>127.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.1</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1909</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>144.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.24</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2398</th>\n",
       "      <td>0.772727</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>104.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.93</td>\n",
       "      <td>1</td>\n",
       "      <td>112.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>275</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>107.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.85</td>\n",
       "      <td>1</td>\n",
       "      <td>126.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>633 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           age  query_on_thyroxine  on_antithyroid_medication  \\\n",
       "956   0.757576                   1                          0   \n",
       "1009  0.883838                   0                          0   \n",
       "2187  0.797980                   0                          0   \n",
       "961   0.904040                   0                          0   \n",
       "2514  0.606061                   0                          0   \n",
       "...        ...                 ...                        ...   \n",
       "2864  0.691919                   0                          0   \n",
       "1034  0.782828                   0                          0   \n",
       "1909  0.782828                   0                          0   \n",
       "2398  0.772727                   0                          0   \n",
       "275   0.904040                   0                          0   \n",
       "\n",
       "      thyroid_surgery  query_hypothyroid  query_hyperthyroid  pregnant  sick  \\\n",
       "956                 0                  0                   0         0     0   \n",
       "1009                0                  0                   0         0     0   \n",
       "2187                0                  0                   0         0     0   \n",
       "961                 1                  1                   0         0     0   \n",
       "2514                0                  0                   0         0     0   \n",
       "...               ...                ...                 ...       ...   ...   \n",
       "2864                0                  0                   0         0     0   \n",
       "1034                0                  0                   0         0     0   \n",
       "1909                0                  0                   0         0     0   \n",
       "2398                0                  0                   0         0     0   \n",
       "275                 0                  0                   0         0     0   \n",
       "\n",
       "      tumor  lithium  ...    TT4  T4U_measured   T4U  FTI_measured    FTI  \\\n",
       "956       0        0  ...  122.0             1  0.75             1  162.0   \n",
       "1009      0        0  ...  122.0             1  1.03             1  119.0   \n",
       "2187      0        0  ...   67.0             1  0.82             1   82.0   \n",
       "961       0        0  ...  111.0             1  0.87             1  127.0   \n",
       "2514      0        0  ...  149.0             1  0.99             1  150.0   \n",
       "...     ...      ...  ...    ...           ...   ...           ...    ...   \n",
       "2864      0        0  ...   95.0             1  0.97             1   99.0   \n",
       "1034      0        0  ...  127.0             1   1.1             1  116.0   \n",
       "1909      0        0  ...  144.0             1  1.24             1  116.0   \n",
       "2398      0        0  ...  104.0             1  0.93             1  112.0   \n",
       "275       0        0  ...  107.0             1  0.85             1  126.0   \n",
       "\n",
       "      TBG_measured   TBG  sex_M sex_nan  on_thyroxine_t  \n",
       "956              0  -100      0       0               0  \n",
       "1009             0  -100      0       0               0  \n",
       "2187             0  -100      0       0               1  \n",
       "961              0  -100      0       0               0  \n",
       "2514             0  -100      1       0               1  \n",
       "...            ...   ...    ...     ...             ...  \n",
       "2864             0  -100      0       0               0  \n",
       "1034             0  -100      1       0               1  \n",
       "1909             0  -100      0       0               0  \n",
       "2398             0  -100      1       0               0  \n",
       "275              0  -100      0       0               0  \n",
       "\n",
       "[633 rows x 26 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from feature_engine.wrappers import SklearnTransformerWrapper\n",
    "\n",
    "imputer = SklearnTransformerWrapper(transformer=SimpleImputer(strategy=\"constant\", fill_value=-100))\n",
    "\n",
    "pipe = Pipeline([\n",
    "            (\"encoder_ohe\", dp.EncoderOHE(col_encode=[\"sex\", \"on_thyroxine\"])), # dataprocessing\n",
    "            (\"imputer\", imputer),                                               # sklearn\n",
    "            (\"scaler\", dp.DataMinMaxScaler(include_cols=[\"age\"])),                  # dataprocessing\n",
    "            (\"ordinal_encoder\", dp.EncoderOrdinal(verbose=False)),              # dataprocessing\n",
    "        ])\n",
    "pipe.fit(train_x, train_y)\n",
    "new_x_test = pipe.transform(test_x)\n",
    "new_x_test"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Solution 3: Wrap the Pipeline class and apply solution 2 automatically\n",
    "\n",
    "We can also create a wrapper over the **Pipeline** class that automatically applies Solution 2 to the transformers in the pipeline. This extension, called here the **PipelineWrapper**, provides a simple modification: all transformers that are not from the **dataprocessing** library are wrapped around the **SklearnTransformerWrapper** class. Therefore, the **PipelineWrapper** executes the previous solution internally, removing the burden of wrapping all of **SKLearn's** transformers from the hands of the user. The **PipelineWrapper** doesn't change any other behavior from the **Pipeline** class, and therefore, the latter can be replaced by the former without any changes in the behavior of the code.\n",
    "\n",
    "First, let's create the **PipelineWrapper** class. This class inherits from the **Pipeline** class. The only modification that we make is that we call a new method, called **_wrap_skl_transf()**, in the *init* method. This method will check all transformers in the pipeline and wrap all of the SKLearn's transformers in the **SklearnTransformerWrapper**. This guarantees that, if the input is a pandas dataframe, the transformers from SKLearn will also output a dataframe."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "from feature_engine.wrappers.wrappers import _ALL_TRANSFORMERS\n",
    "\n",
    "class PipelineWrapper(Pipeline):\n",
    "\n",
    "    # -----------------------------------\n",
    "    def __init__(self, steps, *, memory=None, verbose=False):\n",
    "        super().__init__(steps, memory=memory, verbose=verbose)\n",
    "        self._wrap_skl_transf()\n",
    "\n",
    "    # -----------------------------------\n",
    "    def _wrap_skl_transf(self):\n",
    "        for i in range(len(self.steps)):\n",
    "            name, transform = self.steps[i]\n",
    "            if not isinstance(transform, dp.DataProcessing):\n",
    "                if not isinstance(transform, SklearnTransformerWrapper):\n",
    "                    if transform.__class__.__name__ in _ALL_TRANSFORMERS:\n",
    "                        transform = SklearnTransformerWrapper(transformer=transform)\n",
    "                        self.steps[i] = (name, transform)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now let's use the **PipelineWrapper** instead of the **Pipeline** class. Note that nothing changes, except that now we can use the column names even after a transformer from the **SKLearn** library."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>query_on_thyroxine</th>\n",
       "      <th>on_antithyroid_medication</th>\n",
       "      <th>thyroid_surgery</th>\n",
       "      <th>query_hypothyroid</th>\n",
       "      <th>query_hyperthyroid</th>\n",
       "      <th>pregnant</th>\n",
       "      <th>sick</th>\n",
       "      <th>tumor</th>\n",
       "      <th>lithium</th>\n",
       "      <th>...</th>\n",
       "      <th>TT4</th>\n",
       "      <th>T4U_measured</th>\n",
       "      <th>T4U</th>\n",
       "      <th>FTI_measured</th>\n",
       "      <th>FTI</th>\n",
       "      <th>TBG_measured</th>\n",
       "      <th>TBG</th>\n",
       "      <th>sex_M</th>\n",
       "      <th>sex_nan</th>\n",
       "      <th>on_thyroxine_t</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>956</th>\n",
       "      <td>0.757576</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.75</td>\n",
       "      <td>1</td>\n",
       "      <td>162.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1009</th>\n",
       "      <td>0.883838</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>122.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.03</td>\n",
       "      <td>1</td>\n",
       "      <td>119.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2187</th>\n",
       "      <td>0.797980</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>67.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.82</td>\n",
       "      <td>1</td>\n",
       "      <td>82.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>961</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>111.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.87</td>\n",
       "      <td>1</td>\n",
       "      <td>127.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2514</th>\n",
       "      <td>0.606061</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>149.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.99</td>\n",
       "      <td>1</td>\n",
       "      <td>150.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2864</th>\n",
       "      <td>0.691919</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>95.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.97</td>\n",
       "      <td>1</td>\n",
       "      <td>99.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1034</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>127.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.1</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1909</th>\n",
       "      <td>0.782828</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>144.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.24</td>\n",
       "      <td>1</td>\n",
       "      <td>116.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2398</th>\n",
       "      <td>0.772727</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>104.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.93</td>\n",
       "      <td>1</td>\n",
       "      <td>112.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>275</th>\n",
       "      <td>0.904040</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>107.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.85</td>\n",
       "      <td>1</td>\n",
       "      <td>126.0</td>\n",
       "      <td>0</td>\n",
       "      <td>-100</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>633 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           age  query_on_thyroxine  on_antithyroid_medication  \\\n",
       "956   0.757576                   1                          0   \n",
       "1009  0.883838                   0                          0   \n",
       "2187  0.797980                   0                          0   \n",
       "961   0.904040                   0                          0   \n",
       "2514  0.606061                   0                          0   \n",
       "...        ...                 ...                        ...   \n",
       "2864  0.691919                   0                          0   \n",
       "1034  0.782828                   0                          0   \n",
       "1909  0.782828                   0                          0   \n",
       "2398  0.772727                   0                          0   \n",
       "275   0.904040                   0                          0   \n",
       "\n",
       "      thyroid_surgery  query_hypothyroid  query_hyperthyroid  pregnant  sick  \\\n",
       "956                 0                  0                   0         0     0   \n",
       "1009                0                  0                   0         0     0   \n",
       "2187                0                  0                   0         0     0   \n",
       "961                 1                  1                   0         0     0   \n",
       "2514                0                  0                   0         0     0   \n",
       "...               ...                ...                 ...       ...   ...   \n",
       "2864                0                  0                   0         0     0   \n",
       "1034                0                  0                   0         0     0   \n",
       "1909                0                  0                   0         0     0   \n",
       "2398                0                  0                   0         0     0   \n",
       "275                 0                  0                   0         0     0   \n",
       "\n",
       "      tumor  lithium  ...    TT4  T4U_measured   T4U  FTI_measured    FTI  \\\n",
       "956       0        0  ...  122.0             1  0.75             1  162.0   \n",
       "1009      0        0  ...  122.0             1  1.03             1  119.0   \n",
       "2187      0        0  ...   67.0             1  0.82             1   82.0   \n",
       "961       0        0  ...  111.0             1  0.87             1  127.0   \n",
       "2514      0        0  ...  149.0             1  0.99             1  150.0   \n",
       "...     ...      ...  ...    ...           ...   ...           ...    ...   \n",
       "2864      0        0  ...   95.0             1  0.97             1   99.0   \n",
       "1034      0        0  ...  127.0             1   1.1             1  116.0   \n",
       "1909      0        0  ...  144.0             1  1.24             1  116.0   \n",
       "2398      0        0  ...  104.0             1  0.93             1  112.0   \n",
       "275       0        0  ...  107.0             1  0.85             1  126.0   \n",
       "\n",
       "      TBG_measured   TBG  sex_M sex_nan  on_thyroxine_t  \n",
       "956              0  -100      0       0               0  \n",
       "1009             0  -100      0       0               0  \n",
       "2187             0  -100      0       0               1  \n",
       "961              0  -100      0       0               0  \n",
       "2514             0  -100      1       0               1  \n",
       "...            ...   ...    ...     ...             ...  \n",
       "2864             0  -100      0       0               0  \n",
       "1034             0  -100      1       0               1  \n",
       "1909             0  -100      0       0               0  \n",
       "2398             0  -100      1       0               0  \n",
       "275              0  -100      0       0               0  \n",
       "\n",
       "[633 rows x 26 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pipe = PipelineWrapper([\n",
    "            (\"encoder_ohe\", dp.EncoderOHE(col_encode=[\"sex\", \"on_thyroxine\"])), # dataprocessing\n",
    "            (\"imputer\", SimpleImputer(strategy=\"constant\", fill_value=-100)),   # sklearn\n",
    "            (\"scaler\", dp.DataMinMaxScaler(include_cols=[\"age\"])),              # dataprocessing\n",
    "            (\"ordinal_encoder\", dp.EncoderOrdinal(verbose=False)),              # dataprocessing\n",
    "        ])\n",
    "pipe.fit(train_x, train_y)\n",
    "new_x_test = pipe.transform(test_x)\n",
    "new_x_test"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3.8.13 ('rai')",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  },
  "orig_nbformat": 4,
  "vscode": {
   "interpreter": {
    "hash": "5215fd1cce9b64233b490e6c4e868a314fa8a5a2b064fe0583fd0c29542af034"
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
