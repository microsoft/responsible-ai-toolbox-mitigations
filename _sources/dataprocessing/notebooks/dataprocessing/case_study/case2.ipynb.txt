{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import uci_dataset as database\n",
    "\n",
    "import raimitigations.dataprocessing as dp"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Case Study 2\n",
    "\n",
    "# 1 - Understanding the Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>class</th>\n",
       "      <th>GLCM_pan</th>\n",
       "      <th>Mean_Green</th>\n",
       "      <th>Mean_Red</th>\n",
       "      <th>Mean_NIR</th>\n",
       "      <th>SD_pan</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>w</td>\n",
       "      <td>120.362774</td>\n",
       "      <td>205.500000</td>\n",
       "      <td>119.395349</td>\n",
       "      <td>416.581395</td>\n",
       "      <td>20.676318</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>w</td>\n",
       "      <td>124.739583</td>\n",
       "      <td>202.800000</td>\n",
       "      <td>115.333333</td>\n",
       "      <td>354.333333</td>\n",
       "      <td>16.707151</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>w</td>\n",
       "      <td>134.691964</td>\n",
       "      <td>199.285714</td>\n",
       "      <td>116.857143</td>\n",
       "      <td>477.857143</td>\n",
       "      <td>22.496712</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>w</td>\n",
       "      <td>127.946309</td>\n",
       "      <td>178.368421</td>\n",
       "      <td>92.368421</td>\n",
       "      <td>278.473684</td>\n",
       "      <td>14.977453</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>w</td>\n",
       "      <td>135.431548</td>\n",
       "      <td>197.000000</td>\n",
       "      <td>112.690476</td>\n",
       "      <td>532.952381</td>\n",
       "      <td>17.604193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>495</th>\n",
       "      <td>n</td>\n",
       "      <td>123.554348</td>\n",
       "      <td>202.826087</td>\n",
       "      <td>106.391304</td>\n",
       "      <td>364.565217</td>\n",
       "      <td>17.314068</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>496</th>\n",
       "      <td>n</td>\n",
       "      <td>121.549028</td>\n",
       "      <td>276.220000</td>\n",
       "      <td>175.593333</td>\n",
       "      <td>402.620000</td>\n",
       "      <td>13.394574</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>497</th>\n",
       "      <td>n</td>\n",
       "      <td>119.076687</td>\n",
       "      <td>247.951220</td>\n",
       "      <td>113.365854</td>\n",
       "      <td>808.024390</td>\n",
       "      <td>24.830059</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>498</th>\n",
       "      <td>n</td>\n",
       "      <td>107.944444</td>\n",
       "      <td>197.000000</td>\n",
       "      <td>90.000000</td>\n",
       "      <td>451.000000</td>\n",
       "      <td>8.214887</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>499</th>\n",
       "      <td>n</td>\n",
       "      <td>119.731928</td>\n",
       "      <td>182.238095</td>\n",
       "      <td>74.285714</td>\n",
       "      <td>301.690476</td>\n",
       "      <td>22.944278</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4839 rows Ã— 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    class    GLCM_pan  Mean_Green    Mean_Red    Mean_NIR     SD_pan\n",
       "0       w  120.362774  205.500000  119.395349  416.581395  20.676318\n",
       "1       w  124.739583  202.800000  115.333333  354.333333  16.707151\n",
       "2       w  134.691964  199.285714  116.857143  477.857143  22.496712\n",
       "3       w  127.946309  178.368421   92.368421  278.473684  14.977453\n",
       "4       w  135.431548  197.000000  112.690476  532.952381  17.604193\n",
       "..    ...         ...         ...         ...         ...        ...\n",
       "495     n  123.554348  202.826087  106.391304  364.565217  17.314068\n",
       "496     n  121.549028  276.220000  175.593333  402.620000  13.394574\n",
       "497     n  119.076687  247.951220  113.365854  808.024390  24.830059\n",
       "498     n  107.944444  197.000000   90.000000  451.000000   8.214887\n",
       "499     n  119.731928  182.238095   74.285714  301.690476  22.944278\n",
       "\n",
       "[4839 rows x 6 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = database.load_wilt()\n",
    "label_col = \"class\"\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 4839 entries, 0 to 499\n",
      "Data columns (total 6 columns):\n",
      " #   Column      Non-Null Count  Dtype  \n",
      "---  ------      --------------  -----  \n",
      " 0   class       4839 non-null   int64  \n",
      " 1   GLCM_pan    4839 non-null   float64\n",
      " 2   Mean_Green  4839 non-null   float64\n",
      " 3   Mean_Red    4839 non-null   float64\n",
      " 4   Mean_NIR    4839 non-null   float64\n",
      " 5   SD_pan      4839 non-null   float64\n",
      "dtypes: float64(5), int64(1)\n",
      "memory usage: 264.6 KB\n"
     ]
    }
   ],
   "source": [
    "df[label_col] = df[label_col].replace({\"w\": 1, \"n\": 0})\n",
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No correlations detected. Nothing to be done here.\n"
     ]
    }
   ],
   "source": [
    "cor_feat = dp.CorrelatedFeatures(\n",
    "\t\t\t\t\tmethod_num_num=[\"spearman\", \"pearson\", \"kendall\"],\t\t\t\t# Used for Numerical x Numerical correlations\n",
    "\t\t\t\t\tnum_corr_th=0.9,\t\t\t\t\t\t\t\t\t\t\t\t# Used for Numerical x Numerical correlations\n",
    "\t\t\t\t\tnum_pvalue_th=0.05,\t\t\t\t\t\t\t\t\t\t\t\t# Used for Numerical x Numerical correlations\n",
    "\t\t\t\t\tmethod_num_cat=\"model\",\t\t\t\t\t\t\t\t\t\t\t# Used for Numerical x Categorical correlations\n",
    "\t\t\t\t\tmodel_metrics=[\"f1\", \"auc\"],\t\t\t\t\t\t\t\t\t# Used for Numerical x Categorical correlations\n",
    "\t\t\t\t\tmetric_th=0.9,\t\t\t\t\t\t\t\t\t\t\t\t\t# Used for Numerical x Categorical correlations\n",
    "\t\t\t\t\tcat_corr_th=0.9,\t\t\t\t\t\t\t\t\t\t\t\t# Used for Categorical x Categorical correlations\n",
    "\t\t\t\t\tcat_pvalue_th=0.01,\t\t\t\t\t\t\t\t\t\t\t\t# Used for Categorical x Categorical correlations\n",
    "\t\t\t\t\tjson_summary=\"./corr_json/c2_summary.json\",\n",
    "\t\t\t\t\tjson_corr=\"./corr_json/c2_corr.json\",\n",
    "\t\t\t\t\tjson_uncorr=\"./corr_json/c2_uncorr.json\"\n",
    "\t\t\t\t)\n",
    "cor_feat.fit(df=df, label_col=label_col)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Remember to look through the JSON files generated in the previous cell"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 2 - Baseline Models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "train_x, test_x, train_y, test_y = dp.split_data(df, label_col, test_size=0.25)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/xgboost/sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].\n",
      "  warnings.warn(label_encoder_deprecation_msg, UserWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1076   69]\n",
      " [   9   56]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 93.55%\n",
      "Precision:  0.719852534562212\n",
      "Recall:  0.9006382264024186\n",
      "F1 =  0.777248052867595\n",
      "ROC AUC =  0.94718844474303\n",
      "best_th = 0.12699560821056366\n"
     ]
    }
   ],
   "source": [
    "model = dp.train_model_plot_results(train_x, train_y, test_x, test_y, model_name=\"xgb\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1105   40]\n",
      " [  10   55]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 95.87%\n",
      "Precision:  0.7849893792777909\n",
      "Recall:  0.9056096741686261\n",
      "F1 =  0.8326880530973452\n",
      "ROC AUC =  0.916022841787034\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "model = dp.train_model_plot_results(train_x, train_y, test_x, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 3 - Data Transformation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## DataMinMaxScaler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1015  130]\n",
      " [  22   43]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 87.44%\n",
      "Precision:  0.6136699349501954\n",
      "Recall:  0.7740006718172656\n",
      "F1 =  0.6458418381101295\n",
      "ROC AUC =  0.7831709774941216\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "scaler = dp.DataMinMaxScaler()\n",
    "scaler.fit(train_x)\n",
    "train_x_scl = scaler.transform(train_x)\n",
    "test_x_scl = scaler.transform(test_x)\n",
    "model = dp.train_model_plot_results(train_x_scl, train_y, test_x_scl, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## DataNormalizer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No columns specified for imputation. These columns have been automatically identified:\n",
      "[]\n",
      "WARNING: No columns with NaN values identified. Nothing to be done.\n",
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1080   65]\n",
      " [   4   61]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 94.30%\n",
      "Precision:  0.7402184736133076\n",
      "Recall:  0.9408464897547867\n",
      "F1 =  0.8038939350165242\n",
      "ROC AUC =  0.9593416190796104\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "scaler = dp.DataNormalizer()\n",
    "scaler.fit(train_x)\n",
    "train_x_scl = scaler.transform(train_x)\n",
    "test_x_scl = scaler.transform(test_x)\n",
    "model = dp.train_model_plot_results(train_x_scl, train_y, test_x_scl, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## DataStandardScaler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1080   65]\n",
      " [  12   53]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 93.64%\n",
      "Precision:  0.7190817656919353\n",
      "Recall:  0.8793080282163251\n",
      "F1 =  0.7724069364952575\n",
      "ROC AUC =  0.8901511588847832\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "scaler = dp.DataStandardScaler()\n",
    "scaler.fit(train_x)\n",
    "train_x_scl = scaler.transform(train_x)\n",
    "test_x_scl = scaler.transform(test_x)\n",
    "model = dp.train_model_plot_results(train_x_scl, train_y, test_x_scl, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## DataQuantileTransformer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1103   42]\n",
      " [   4   61]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 96.20%\n",
      "Precision:  0.7943098201208549\n",
      "Recall:  0.9508901578770574\n",
      "F1 =  0.8528820942231246\n",
      "ROC AUC =  0.960893516963386\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "scaler = dp.DataQuantileTransformer()\n",
    "scaler.fit(train_x)\n",
    "train_x_scl = scaler.transform(train_x)\n",
    "test_x_scl = scaler.transform(test_x)\n",
    "model = dp.train_model_plot_results(train_x_scl, train_y, test_x_scl, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "As we can see, this transformation had some impact in the results (depends on the seed used) when we use KNN. Let's check how this data transformation impacts the XGBoost model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/xgboost/sklearn.py:1224: UserWarning: The use of label encoder in XGBClassifier is deprecated and will be removed in a future release. To remove this warning, do the following: 1) Pass option use_label_encoder=False when constructing XGBClassifier object; and 2) Encode your labels (y) as integers starting with 0, i.e. 0, 1, 2, ..., [num_class - 1].\n",
      "  warnings.warn(label_encoder_deprecation_msg, UserWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1076   69]\n",
      " [   9   56]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 93.55%\n",
      "Precision:  0.719852534562212\n",
      "Recall:  0.9006382264024186\n",
      "F1 =  0.777248052867595\n",
      "ROC AUC =  0.9457910648303662\n",
      "best_th = 0.12699560821056366\n"
     ]
    }
   ],
   "source": [
    "model = dp.train_model_plot_results(train_x_scl, train_y, test_x_scl, test_y, model_name=\"xgb\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "As depicted above, the results for the XGBoost remains the same as before. This shows us that data transformations are more impactful in certain models and less meaningful in others.\n",
    "\n",
    "## DataRobustScaler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1109   36]\n",
      " [   7   58]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 96.45%\n",
      "Precision:  0.8053744375810264\n",
      "Recall:  0.930433322136379\n",
      "F1 =  0.8552708074292279\n",
      "ROC AUC =  0.9397715821296606\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "scaler = dp.DataRobustScaler()\n",
    "scaler.fit(train_x)\n",
    "train_x_scl = scaler.transform(train_x)\n",
    "test_x_scl = scaler.transform(test_x)\n",
    "model = dp.train_model_plot_results(train_x_scl, train_y, test_x_scl, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## DataPowerTransformer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1111   34]\n",
      " [   6   59]]\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAATUAAAEWCAYAAAAHJwCcAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAekklEQVR4nO3de5xVZd3+8c81MyIHAcFBBQRFRZQ0FUkTFDW1wGNmKWppZZEl2qOZ2VOh8aSVpllKP7Myj2n6mImJgplnxTh4BE88KmfkICIqCjN8f3/sNbhngpm9YfbsNWuud6/9aq+17n2v70a5vNfp3ooIzMyyoqLcBZiZNSeHmpllikPNzDLFoWZmmeJQM7NMcaiZWaY41DJGUgdJ90haIemOTejnFEmTmrO2cpB0n6TTyl2HtRyHWplIOlnSVEnvSVqY/OU7oBm6/iKwDbBVRHxpYzuJiFsi4rPNUE89kg6WFJLuarB+z2T9wwX2c5Gkm5tqFxEjIuKGjSzXWiGHWhlIOhe4EriEXAD1BX4HHNsM3W8PvBoRNc3QV6ksAfaXtFXeutOAV5trB8rxv99tUUT41YIvoCvwHvClRtpsTi70FiSvK4HNk20HA/OA7wGLgYXA15JtPwVWA2uSfZwOXATcnNf3DkAAVcnyV4HXgZXAG8Apeesfz/vcEGAKsCL5/yF52x4G/gd4IulnElC9ge9WV/81wJnJukpgPjAGeDiv7W+AucC7wDTgwGT98Abf87m8Oi5O6lgF7Jys+0ay/f8Bd+b1/0vgQUDl/vfCr+Z7+b9kLW9/oD1wVyNtfgR8GtgL2BPYF/hx3vZtyYVjb3LBNU5St4i4kNzo768RsUVE/KmxQiR1An4LjIiIzuSC69n1tOsO3Ju03Qq4Ari3wUjrZOBrwNZAO+C8xvYN3Aicmrz/HPAiuQDPN4Xcn0F34C/AHZLaR8T9Db7nnnmf+QowCugMzG7Q3/eAPSR9VdKB5P7sTosk4SwbHGotbytgaTR+eHgKMDYiFkfEEnIjsK/kbV+TbF8TERPIjVYGbGQ9a4HdJXWIiIURMWM9bY4EXouImyKiJiJuBV4Gjs5r8+eIeDUiVgG3kwujDYqIJ4HukgaQC7cb19Pm5ohYluzzcnIj2Ka+5/URMSP5zJoG/X1A7s/xCuBm4KyImNdEf9bKONRa3jKgWlJVI216UX+UMTtZt66PBqH4AbBFsYVExPvAicAZwEJJ90ratYB66mrqnbe8aCPquQkYDRzCekauks6T9FJyJfcdcqPT6ib6nNvYxoh4mtzhtsiFr2WMQ63lPQV8BHy+kTYLyJ3wr9OX/zw0K9T7QMe85W3zN0bExIg4HOhJbvT1hwLqqatp/kbWVOcm4DvAhGQUtU5yeHg+cALQLSK2JHc+T3Wlb6DPRg8lJZ1JbsS3IOnfMsah1sIiYgW5E+LjJH1eUkdJm0kaIenSpNmtwI8l9ZBUnbRv8vaFDXgWGCapr6SuwA/rNkjaRtKxybm1j8gdxq5dTx8TgF2S21CqJJ0IDAT+sZE1ARARbwAHkTuH2FBnoIbcldIqSWOALnnb3wJ2KOYKp6RdgJ8BXyZ3GHq+pL02rnpLK4daGSTnh84ld/J/CblDptHA35MmPwOmAs8DLwDTk3Ubs68HgL8mfU2jfhBVJHUsAN4mFzDfXk8fy4CjyJ1oX0ZuhHNURCzdmJoa9P14RKxvFDoRuJ/cbR6zgQ+pf2hZd2PxMknTm9pPcrh/M/DLiHguIl4D/hu4SdLmm/IdLF3kCz9mliUeqZlZpjjUzCxTHGpmlikONTPLlMZuAG1xquoQate53GVYEfberW+5S7AizJ79JkuXLlXTLTesssv2ETWrCmobq5ZMjIjhm7K/YqUr1Np1ZvMBJ5S7DCvCE09fXe4SrAhD9xu8yX1EzYdsvuvIgtp++MxVTT0B0uxSFWpm1goI0CYN9krKoWZmxUvxVHUONTMrnkdqZpYdgorKchexQQ41MyuO8OGnmWWJfPhpZhnjkZqZZYpHamaWHfJIzcwyRPjqp5lliUdqZpY1FT6nZmZZ4fvUzCxzfPXTzLLDj0mZWdb48NPMMkN+TMrMssYjNTPLFI/UzCw7fPOtmWWJH5Mys2zxSM3Mssbn1MwsUzxSM7NM8UjNzDJDPqdmZhmjCoeamWWEAPnw08wyQ8krpRxqZlYkeaRmZtniUDOzTKnwhQIzywyfUzOzLJHPqZlZ1qQ51NJ7YGxmqSWpoFcB/QyX9IqkWZIuWM/2vpIekvSMpOclHdFUnw41Mytac4SapEpgHDACGAicJGlgg2Y/Bm6PiL2BkcDvmqrNoWZmxRGoQgW9mrAvMCsiXo+I1cBtwLEN2gTQJXnfFVjQVKc+p2ZmRSnyQkG1pKl5y9dGxLXJ+97A3Lxt84D9Gnz+ImCSpLOATsBhTe3QoWZmRSsi1JZGxOBN2NVJwPURcbmk/YGbJO0eEWs39AEffppZ8VTgq3HzgT55y9sl6/KdDtwOEBFPAe2B6sY6daiZWXHUbFc/pwD9JfWT1I7chYDxDdrMAQ4FkLQbuVBb0linPvw0s6I1x31qEVEjaTQwEagErouIGZLGAlMjYjzwPeAPks4hd9HgqxERjfXrUDOzogg127OfETEBmNBg3Zi89zOBocX06VAzs+Kl94ECh5qZFUnpfkzKoWZmRXOomVmmONTMLFMKeASqbBxqm+DQ/Xfj59/7IpUVFdx095NcecMD9bb32bYbV435MtVbbsHydz/gW2NuYMHidzhgn/5ccu7x69r1334bTv/Rn5nwyPMt/RXanH8+OZMfXv6/1K5dy1eOHcI5X/1sve0frV7Dty+8iWdfnkP3rp247pKv07fXVkyb8Sb/dfGtQO6+ggu+eQRHHbJnGb5B+RU6A0e5lDTUJA0HfkPuHpQ/RsQvSrm/llRRIS47/wSOG301C956h3/d8H3ue/QFXnlj0bo2Y797HLfd+29uu/dpDhy8C2POPIYzLryRx6e9xrBTcn8UW3bpyPS/XchDk18q11dpM2pr1/L9S2/nrqtH02ubLfnMaZcxYtge7Lpjz3Vtbrr7Kbp26cD0uy7izklTueiqu7nu519nt5168dCN51NVVcmipSs48OSfM/zA3amqqizjNyqfNIdayZ4oKHBakVZrn0/swOtzlzJ7/jLW1NTytwemc8RBn6zXZsCOPXls6isAPDb1VUYM2+M/+jn20L3551MzWfXRmhapuy2bNuNNduxTzQ7bVdNusyq+cPig/xgd3/fo85x0ZO6Z6mM/szePTHmFiKBj+3brAuyjj9ak+i91S2iu+dRKoZSPSRUyrUir1bNHV+a/tXzd8oK3ltOzR9d6bWa8Op+jDtkLgKMO2ZMuW3SgW9dO9dp84fBB3DlxWsnrNVi4ZAW9t+m2brnXNt1YuGRFvTYLFn/cpqqqki5bdODtFe8DMPXFN9n/hJ8x9KRLuOKCkW12lAY017OfJVHKUFvftCK9GzaSNErSVElTo2ZVCctpeT/5zV0MHbQzj9z8A4YO2pn5by2ntvbjyQW22aoLA3fuxYNPzSxjlVaowbvvwFO3/5gHbzifX18/iQ/b8Og6zSO1sl8oSOZWuhagouPWjT7TlSaF/Fd/0dIVnHr+HwHo1KEdRx+yF+++93Fwf/7wQfzj4eepqd3gLCrWjAoZXffaOtem9zbdqKmp5d33VtG9weh6QL9t6dRxc176vwXsPXD7Fqk9TaTcOeW0KuVIrZBpRVqt6TNns1PfHvTttRWbVVXyhcMHcd+j9c/PdO/aad1/rc756ue45Z7J9bYf/9l9uHPiVKxlDBq4Pf83Zwmz5y9l9Zoa/vbAdEYMq38edPiBe3DrvU8DcPe/nmHYp3ZBErPnL6WmphaAOQvf5rU3F9G311Yt/h3SobBRWhZHauumFSEXZiOBk0u4vxZVW7uW8y+9nTt/eyaVleKW8ZN5+fVF/PBbR/LsS3O479EXOGCf/ow58xgi4MlnZvH9S29f9/k+PbvTe5tuPDF9Vhm/RdtSVVXJpeefwPFnj6O2NjjlmE+z2049ueSaf7DXbn054qBP8pVjh3DGhTcy6LiL6NalE3+6+GsAPPXc6/zm+klUVVVSUSF+9YMT2WrLLcr8jconzddJ1MQsHpvWee6XX67k42lFLm6sfUXHrWPzASeUrB5rfsunXF3uEqwIQ/cbzLRpUzcpktpvu0tsf9pVBbV99dLh0zZx5tuilfSc2vqmFTGzVk7pHqmV/UKBmbUuIt0XChxqZlY0h5qZZYcPP80sS0S6n/10qJlZkdrwLB1mlk0pzjSHmpkVKeWPSTnUzKwoPqdmZpmT4kxzqJlZ8TxSM7NMSXGmOdTMrEj+MWMzyxIhX/00s2xJ8UDNoWZmxfPhp5llhx9oN7Ms8c23ZpY5DjUzyxRf/TSz7PA5NTPLEnk+NTPLmhRnWkl/od3MMqpCKujVFEnDJb0iaZakCzbQ5gRJMyXNkPSXpvr0SM3MiqJmmiRSUiUwDjgcmAdMkTQ+ImbmtekP/BAYGhHLJW3dVL8eqZlZ0SpU2KsJ+wKzIuL1iFgN3AYc26DNN4FxEbEcICIWN1lb8V/HzNo6SQW9gGpJU/Neo/K66Q3MzVuel6zLtwuwi6QnJE2WNLyp2jZ4+CnpKiA2tD0izm6qczPLpiIuFCyNiMGbsKsqoD9wMLAd8KikPSLincY+sCFTN6EQM8sokbutoxnMB/rkLW+XrMs3D3g6ItYAb0h6lVzITdlQpxsMtYi4IX9ZUseI+KDYqs0se5rpgYIpQH9J/ciF2Ujg5AZt/g6cBPxZUjW5w9HXG62tqb1K2l/STODlZHlPSb8runwzywblJoks5NWYiKgBRgMTgZeA2yNihqSxko5Jmk0EliUZ9BDw/YhY1li/hdzScSXwOWB8UshzkoYV8DkzyyBBQfegFSIiJgATGqwbk/c+gHOTV0EKuk8tIuY2eCyittAdmFn2pPmJgkJCba6kIUBI2gz4Lrmhopm1UWl+9rOQ+9TOAM4kd//IAmCvZNnM2iCp8Fc5NDlSi4ilwCktUIuZtRKVrXmkJmlHSfdIWiJpsaS7Je3YEsWZWToV8URBiyvk8PMvwO1AT6AXcAdwaymLMrP0yl39bJZnP0uikFDrGBE3RURN8roZaF/qwswspQocpZVrpNbYs5/dk7f3JfMc3UbuWdATaXBfiZm1LSk+pdbohYJp5EKsrvxv5W0LcnMcmVkblOZbOhp79rNfSxZiZq2DgMrW/mtSknYHBpJ3Li0ibixVUWaWbumNtAJCTdKF5OYyGkjuXNoI4HHAoWbWBknN9+xnKRRy9fOLwKHAooj4GrAn0LWkVZlZqrXqJwqAVRGxVlKNpC7AYupP7GZmbUyrvFCQZ6qkLYE/kLsi+h7wVCmLMrN0S3GmFfTs53eSt9dIuh/oEhHPl7YsM0srSa3z6qekQY1ti4jppSnJzNKutR5+Xt7ItgA+08y18Mld+zDpkV83d7dWQt0+e0m5S7AifPTawmbpJ82/rdnYzbeHtGQhZtY6iNY7UjMzW68Un1JzqJlZcaQMPCZlZpYvxZlW0My3kvRlSWOS5b6S9i19aWaWVml+oqCQixi/A/Yn9yvJACuBcSWryMxSre53Pwt5lUMhh5/7RcQgSc8ARMRySe1KXJeZpVirvKUjzxpJleTuTUNSD2BtSasys1RL8R0dBYXab4G7gK0lXUxu1o4fl7QqM0utVvuYVJ2IuEXSNHLTDwn4fET4F9rN2rAUZ1pBk0T2BT4A7slfFxFzSlmYmaVT3YWCtCrk8PNePv4BlvZAP+AV4BMlrMvMUizFmVbQ4ece+cvJ7B3f2UBzM8u6Mv5QcSGKfqIgIqZL2q8UxZhZ66AU//RKIefUzs1brAAGAQtKVpGZpZqAqhTfqFbISK1z3vsacufY7ixNOWbWGrTaqYeSm247R8R5LVSPmaVc7upnuavYsMam866KiBpJQ1uyIDNLuTI+rF6IxkZq/yZ3/uxZSeOBO4D36zZGxN9KXJuZpVSa71Mr5HRfe2AZud8kOAo4Ovl/M2uDBFRWFPZqsi9puKRXJM2SdEEj7Y6XFJIGN9VnYyO1rZMrny/y8c23daLpcs0sm0RFM9zSkZyzHwccDswDpkgaHxEzG7TrDHwXeLqQfhvL0kpgi+TVOe993cvM2qDcD680yySR+wKzIuL1iFgN3AYcu552/wP8EviwkPoaG6ktjIixhXRiZm1IcU8UVEuamrd8bURcm7zvDczN2zYPqHdjf/IEU5+IuFfS9wvZYWOhlt4zgWZWVkVcKFgaEU2eB1sfSRXAFcBXi/lcY6F26MYUYmbZVnf42QzmA33ylrdL1tXpDOwOPJzc7LstMF7SMRGRP/qrp7EfM357k8o1s8xqpkkipwD9JfUjF2YjgZPrNkbECqC6blnSw8B5jQUapHuqcTNLIZELjkJejYmIGmA0MBF4Cbg9ImZIGivpmI2tz7/7aWbFUfM9+xkRE4AJDdaN2UDbgwvp06FmZkVL81VEh5qZFSUL03mbmdWT3khzqJlZ0URFiucecqiZWVHqrn6mlUPNzIrWame+NTNbn/RGmkPNzIrVjPeplYJDzcyKIqDSoWZmWZLeSHOomdlGSPFAzaFmZsXJ3dKR3lRzqJlZ0TxSM7MMEfJIzcyywlc/zSxbWvEvtJuZrZdDzcwyxefUzCwzcpNElruKDXOomVnRPPOtmWWKDz8z5OGnX+Knv72L2rXByCP34ztfPqze9o9W13Duxbfwwqvz6NalI1dfdBp9enZn9Zoa/vtXd/D8y3OpqBAXnn0c+++9M6s+XM23x1zPnAXLqKgQhw35BBeccXSZvl32HTp4R37+7cOprBA33f8cV/71qXrb+2zdhau+dxTVXTuyfOUqvvXL8SxYuhKAOy4+kU/t1pvJL85l5Jg7ylF+KqT98LNkE1hKuk7SYkkvlmofLa22di0/+fWd3HDZKP554w8Y/+AzvPrmonpt/nrvZLp27sCjt/6I0084iF9ccw8At94zGYBJN5zPzVecwc/G3c3atWsBGDXyEP518w+Z8KfzmPriGzw0+aWW/WJtREWFuGz05/jSj/7Kp795LccfPJABfavrtRk76lBu++cLHHDGH7n0lscZ8/WD12276o6nOePS8S1cdRqp4P+VQyln5b0eGF7C/lvcsy/NYYfe1fTtVU27zao4+tC9eeDx+pn9wOMvcvzwfQE44qA9eWL6a0QEr725iCGDdgagultnumzRgedfnkuH9u0YMqg/AO02q2L3/tuxaMk7Lfq92op9BvTi9QXLmb3oHdbUrOVvj8zkiCH967UZ0Leax559E4DHnp3NiP13Wbft0WffZOUHq1uy5HRK7lMr5FUOJQu1iHgUeLtU/ZfDoqXv0HPrLdct9+zRlUVLVjRos4JeSZuqqko6d2rP8hXvM3DnXjzwxAxqamqZs2AZL746lwWL36n32RUrV/HPJ2cwdJ/6f9GsefSs7sz8Je+uW16wZCU9t+pcr82M1xdz1NBdAThq6AC6dNqcbp07tGidrYEKfJVD2c+pSRoFjALYrk/fMldTOiccsR+zZr/F0aOuoPc23Rn0iX5UVn7835SamlrOGnsjXzt+GH17VTfSk5XST659kEtHf46TP7sHT74wl/lL3qU2OU1gOX5MqgkRcS1wLcBeg/aJMpfTqG2rt2Rh3uhq4ZIVbNuja4M2XVmwODeiq6mpZeX7H9KtayckMeas49a1O+7bv6Ffnx7rli/41e30264Hp59wUMm/R1u1cOlKevfosm65V4/OLFy2sl6bRW+/x6lj7wSgU/vNOPqAAbz7/kctWmerkN5MS/UvXaXOnrv24Y15S5izYBmr19Rwz4PPcPjQT9Rrc9jQ3bnz/n8DMOGR5xgyaGckserD1XywKveX47Epr1BVWcEuO2wLwGV/mMDK9z7kwrM+36Lfp62Z/soCdurdjb7bdmWzqgq+cNBA7nvqtXptunfpsO5c0Dkjh3DLxOfLUGn6pflCQdlHaq1JVVUlY//reE497/fUrl3LCUfsxy79enL5n+7jkwP6cPgBu3PikftxzsW3MOyki9myc0euvugrACxd/h6nnncNkti2R1d+/eNTAFi4+B2uvukBduq7NUd+43IATv3CgZx01KfL9j2zqnZtcP7Vk7jzkpFUVlRwy8TneHn2Un546jCefXUh901+jQP23J4xXz+YiODJF+by/asnrvv8hMu/Qv8+W9Gpw2a8eMtozr7iXv417Y0yfqPySfHRJ4oozRGfpFuBg4Fq4C3gwoj4U2Of2WvQPjHpkcklqcdKY/tjLyt3CVaEj6aOY+278zcpknbbY++48e6HC2q7705bTouIwZuyv2KVbKQWESeVqm8zK7MUj9R8+GlmRZH87KeZZUx6I82hZmYbI8Wp5lAzsyL5h1fMLGNSfErNoWZmxRHpDjU/UWBmRWuuJwokDZf0iqRZki5Yz/ZzJc2U9LykByVt31SfDjUzK1pzTD0kqRIYB4wABgInSRrYoNkzwOCI+CTwv8ClTdXmUDOzojXT1EP7ArMi4vWIWA3cBhyb3yAiHoqID5LFycB2TXXqUDOz4hSaaLlUq5Y0Ne81Kq+n3sDcvOV5yboNOR24r6nyfKHAzIpWxC0dS5vj2U9JXwYGA03OzeVQM7OiNOMPr8wH+uQtb5esq78/6TDgR8BBEdHk5HY+/DSz4jXPSbUpQH9J/SS1A0YC9X7ZRtLewO+BYyJicSGleaRmZkVrjicKIqJG0mhgIlAJXBcRMySNBaZGxHjgMmAL4A7lLqfOiYhjGuvXoWZmRWuum28jYgIwocG6MXnvD/uPDzXBoWZmRUvxAwUONTPbCClONYeamRXFk0SaWeakN9Icama2MVKcag41MyuSJ4k0s4xJ8Sk1h5qZFSftk0Q61MysaD78NLNM8UjNzDIlxZnmUDOzIhUwVXc5OdTMbCOkN9UcamZWlGacJLIkHGpmVjQffppZpviWDjPLlvRmmkPNzIqX4kxzqJlZcQr59fVycqiZWdGU4lRzqJlZ0dIbaQ41M9sIKR6oOdTMrFieJNLMMsTzqZlZ5jjUzCxTfPhpZtnh+9TMLEuEb+kws6xJcao51MysaD6nZmaZ4kkizSxbHGpmliU+/DSzzEj7EwWKiHLXsI6kJcDsctdRAtXA0nIXYUXJ6j+z7SOix6Z0IOl+cn8+hVgaEcM3ZX/FSlWoZZWkqRExuNx1WOH8z6z1qih3AWZmzcmhZmaZ4lBrGdeWuwArmv+ZtVI+p2ZmmeKRmpllikPNzDLFoVZCkoZLekXSLEkXlLsea5qk6yQtlvRiuWuxjeNQKxFJlcA4YAQwEDhJ0sDyVmUFuB5o0ZtFrXk51EpnX2BWRLweEauB24Bjy1yTNSEiHgXeLncdtvEcaqXTG5ibtzwvWWdmJeRQM7NMcaiVznygT97ydsk6Myshh1rpTAH6S+onqR0wEhhf5prMMs+hViIRUQOMBiYCLwG3R8SM8lZlTZF0K/AUMEDSPEmnl7smK44fkzKzTPFIzcwyxaFmZpniUDOzTHGomVmmONTMLFMcaq2IpFpJz0p6UdIdkjpuQl/XS/pi8v6PjT1sL+lgSUM2Yh9vSvqPXx3a0PoGbd4rcl8XSTqv2BotexxqrcuqiNgrInYHVgNn5G+UtFG/4xoR34iImY00ORgoOtTMysGh1no9BuycjKIekzQemCmpUtJlkqZIel7StwCUc3Uyv9s/ga3rOpL0sKTByfvhkqZLek7Sg5J2IBee5ySjxAMl9ZB0Z7KPKZKGJp/dStIkSTMk/RGa/hlvSX+XNC35zKgG236drH9QUo9k3U6S7k8+85ikXZvlT9Myw7/Q3golI7IRwP3JqkHA7hHxRhIMKyLiU5I2B56QNAnYGxhAbm63bYCZwHUN+u0B/AEYlvTVPSLelnQN8F5E/Cpp9xfg1xHxuKS+5J6a2A24EHg8IsZKOhIo5G78ryf76ABMkXRnRCwDOgFTI+IcSWOSvkeT+0GUMyLiNUn7Ab8DPrMRf4yWUQ611qWDpGeT948BfyJ3WPjviHgjWf9Z4JN158uArkB/YBhwa0TUAgsk/Ws9/X8aeLSur4jY0LxihwEDpXUDsS6Stkj28YXks/dKWl7Adzpb0nHJ+z5JrcuAtcBfk/U3A39L9jEEuCNv35sXsA9rQxxqrcuqiNgrf0Xyl/v9/FXAWRExsUG7I5qxjgrg0xHx4XpqKZikg8kF5P4R8YGkh4H2G2geyX7fafhnYJbP59SyZyLwbUmbAUjaRVIn4FHgxOScW0/gkPV8djIwTFK/5LPdk/Urgc557SYBZ9UtSNorefsocHKybgTQrYlauwLLk0DbldxIsU4FUDfaPJncYe27wBuSvpTsQ5L2bGIf1sY41LLnj+TOl01Pfjzk9+RG5HcBryXbbiQ3E0U9EbEEGEXuUO85Pj78uwc4ru5CAXA2MDi5EDGTj6/C/pRcKM4gdxg6p4la7weqJL0E/IJcqNZ5H9g3+Q6fAcYm608BTk/qm4GnSLcGPEuHmWWKR2pmlikONTPLFIeamWWKQ83MMsWhZmaZ4lAzs0xxqJlZpvx/VgDbEisuR6sAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 96.69%\n",
      "Precision:  0.8145185356321175\n",
      "Recall:  0.9389989922741014\n",
      "F1 =  0.8645759885393234\n",
      "ROC AUC =  0.9472489082969431\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "scaler = dp.DataPowerTransformer()\n",
    "scaler.fit(train_x)\n",
    "train_x_scl = scaler.transform(train_x)\n",
    "test_x_scl = scaler.transform(test_x)\n",
    "model = dp.train_model_plot_results(train_x_scl, train_y, test_x_scl, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 4 - Feature Selection"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No columns specified for imputation. These columns have been automatically identified:\n",
      "[]\n",
      "WARNING: No columns with NaN values identified. Nothing to be done.\n",
      "No columns specified for encoding. These columns have been automatically identfied as the following:\n",
      "[]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.\n",
      "[Parallel(n_jobs=4)]: Done   5 out of   5 | elapsed:    0.7s finished\n",
      "\n",
      "[2022-03-16 10:07:03] Features: 4/1 -- score: 0.8816067968906397[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.\n",
      "[Parallel(n_jobs=4)]: Done   4 out of   4 | elapsed:    0.0s finished\n",
      "\n",
      "[2022-03-16 10:07:03] Features: 3/1 -- score: 0.8549936296115336[Parallel(n_jobs=3)]: Using backend LokyBackend with 3 concurrent workers.\n",
      "[Parallel(n_jobs=3)]: Done   3 out of   3 | elapsed:    0.1s finished\n",
      "\n",
      "[2022-03-16 10:07:03] Features: 2/1 -- score: 0.8616183246641761[Parallel(n_jobs=2)]: Using backend LokyBackend with 2 concurrent workers.\n",
      "[Parallel(n_jobs=2)]: Done   2 out of   2 | elapsed:    0.5s finished\n",
      "\n",
      "[2022-03-16 10:07:04] Features: 1/1 -- score: 0.5828580172198672"
     ]
    }
   ],
   "source": [
    "feat_sel = dp.SeqFeatSelection(n_jobs=4, forward=False)\n",
    "feat_sel.fit(X=train_x_scl, y=train_y)\n",
    "train_x_sel = feat_sel.transform(train_x_scl)\n",
    "test_x_sel = feat_sel.transform(test_x_scl)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['GLCM_pan', 'Mean_Green', 'Mean_Red', 'Mean_NIR']"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "feat_sel.get_selected_features()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1114   31]\n",
      " [   4   61]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 97.11%\n",
      "Precision:  0.8297328303647817\n",
      "Recall:  0.955693651326839\n",
      "F1 =  0.8808019341891578\n",
      "ROC AUC =  0.9635807860262008\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "model = dp.train_model_plot_results(train_x_sel, train_y, test_x_sel, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 5 - Synthetic Data\n",
    "\n",
    "## imblearn Library"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    3433\n",
       "1     196\n",
       "Name: class, dtype: int64"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_y.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No columns specified for imputation. These columns have been automatically identified:\n",
      "[]\n",
      "WARNING: No columns with NaN values identified. Nothing to be done.\n",
      "\n",
      "SMOTE.\n",
      "\n",
      "Running oversampling...\n",
      "...finished\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0    3433\n",
       "1     400\n",
       "Name: class, dtype: int64"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rebalance = dp.Rebalance(\n",
    "\t\t\t\tX=train_x_sel,\n",
    "\t\t\t\ty=train_y,\n",
    "\t\t\t\tstrategy_over={0:3433, 1:400},\n",
    "\t\t\t\tover_sampler=True,\n",
    "\t\t\t\tunder_sampler=False\n",
    "\t\t\t)\n",
    "train_x_res, train_y_res = rebalance.fit_resample()\n",
    "train_y_res.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1111   34]\n",
      " [   3   62]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 96.94%\n",
      "Precision:  0.8215701675643328\n",
      "Recall:  0.9620759153510245\n",
      "F1 =  0.8769037033371001\n",
      "ROC AUC =  0.9707625125965738\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "model = dp.train_model_plot_results(train_x_res, train_y_res, test_x_sel, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Creating Artificial Data using Deep Learning\n",
    "\n",
    "### CTGAN\n",
    "\n",
    "Let's use the dataset with the original categorical variables, since CTGAN is capable of dealing with categorical variables internally. We will start by re-encoding the ordinal variables. We then proceed to split the dataset before using the CTGAN. This guarantees that we don't contaminate our test set."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:282: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.\n",
      "  ConvergenceWarning,\n",
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:282: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.\n",
      "  ConvergenceWarning,\n",
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:282: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.\n",
      "  ConvergenceWarning,\n",
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:282: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.\n",
      "  ConvergenceWarning,\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0    3433\n",
       "1     396\n",
       "Name: class, dtype: int64"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "synth = dp.Synthesizer(\n",
    "\t\t\t\tX=train_x_sel,\n",
    "\t\t\t\ty=train_y,\n",
    "\t\t\t\tepochs=400,\n",
    "\t\t\t\tmodel=\"ctgan\",\n",
    "\t\t\t\tload_existing=True\n",
    "\t\t\t)\n",
    "synth.fit()\n",
    "\n",
    "conditions = {label_col:1}\t# create more of the undersampled class\n",
    "syn_train_x, syn_train_y = synth.transform(X=train_x_sel, y=train_y, n_samples=200, conditions=conditions)\n",
    "\n",
    "syn_train_y.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1046   99]\n",
      " [   1   64]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 91.74%\n",
      "Precision:  0.6958414634860923\n",
      "Recall:  0.9490762512596573\n",
      "F1 =  0.7578915354078628\n",
      "ROC AUC =  0.9839234128317098\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "model = dp.train_model_plot_results(syn_train_x, syn_train_y, test_x_sel, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's try creating more artificial instances and check how this impacts the model's performance."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1087   58]\n",
      " [   6   59]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 94.71%\n",
      "Precision:  0.7493920128869809\n",
      "Recall:  0.9285186429291232\n",
      "F1 =  0.8098773433894078\n",
      "ROC AUC =  0.978018139066174\n",
      "best_th = 0.6\n"
     ]
    }
   ],
   "source": [
    "conditions = {label_col:1}\t# create more of the undersampled class\n",
    "syn_train_x, syn_train_y = synth.transform(X=train_x_sel, y=train_y, n_samples=2000, conditions=conditions)\n",
    "\n",
    "model = dp.train_model_plot_results(syn_train_x, syn_train_y, test_x_sel, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### TVAE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:282: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.\n",
      "  ConvergenceWarning,\n",
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:282: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.\n",
      "  ConvergenceWarning,\n",
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:282: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.\n",
      "  ConvergenceWarning,\n",
      "/home/matheus/miniconda3/envs/resp/lib/python3.7/site-packages/sklearn/mixture/_base.py:282: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.\n",
      "  ConvergenceWarning,\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------\n",
      "TEST\n",
      "------------\n",
      "[[1051   94]\n",
      " [   2   63]]\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Acuracy: 92.07%\n",
      "Precision:  0.699687275058825\n",
      "Recall:  0.9435673496808867\n",
      "F1 =  0.7619457492068957\n",
      "ROC AUC =  0.9733087000335909\n",
      "best_th = 0.2\n"
     ]
    }
   ],
   "source": [
    "synth = dp.Synthesizer(\n",
    "\t\t\t\tX=train_x_sel,\n",
    "\t\t\t\ty=train_y,\n",
    "\t\t\t\tepochs=400,\n",
    "\t\t\t\tmodel=\"tvae\",\n",
    "\t\t\t\tload_existing=True\n",
    "\t\t\t)\n",
    "synth.fit()\n",
    "\n",
    "conditions = {label_col:1}\t# create more of the undersampled class\n",
    "syn2_train_x, syn2_train_y = synth.transform(X=train_x_sel, y=train_y, n_samples=200, conditions=conditions)\n",
    "\n",
    "model = dp.train_model_plot_results(syn2_train_x, syn2_train_y, test_x_sel, test_y, model_name=\"knn\", train_result=False, plot_pr=False)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3.9.12 ('rai')",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  },
  "orig_nbformat": 4,
  "vscode": {
   "interpreter": {
    "hash": "5215fd1cce9b64233b490e6c4e868a314fa8a5a2b064fe0583fd0c29542af034"
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
